# 목차

1. []()

---

#  Symmetric-key
## 1. 대칭키 암호(Symmetric-key Algorithm)

- 다른 이름: conventional / private-key / single-key.
- 전통적인 암호화 방식

![](../../_image/2025-10-21-17-09-08.jpg)
- 송신자와 수신자가 **같은 비밀키**를 공유한다.

- 안전한 사용을 위해선 **강한 알고리즘**과 **비밀키 보안**이 필수.
- 키 배포를 위한 **안전 채널**이 전제된다.
`
- 수식
	- $Y=E_K(X), \quad X=D_K(Y)$.
	- $E$: Encryption, $D$: Decryption, $K$: Key

## 2. 치환 암호 (Substitution Ciphers)
### 2.1. 정의

평문을 이루는 **단위(문자, 기호, 비트 패턴)** 를 **다른 단위로 바꾸는** 방식의 암호이다.
- 문자 기준: 한 글자  →  다른 **글자/숫자/기호**
- 비트 기준: 고정 길이 **비트 패턴**  →  **다른 비트 패턴**

### 2.2. 특징

- 치환은 “무엇으로 바꿀지”의 **매핑 표**가 핵심
- 고전 치환은 **빈도 분석**에 취약
- 현대 암호는 치환(S-box)과 전치(퍼뮤테이션)를 **여러 라운드**로 조합해 강한 보안을 달성합니다.

### 2.3. 주요 종류

- **단일 알파벳(모노알파벳)**: 전체 메시지에 하나의 고정 치환표 사용
	- 예: **카이사르 (시저) 암호**(알파벳 3칸 평행이동).
		- $c = E(p) = (p+k) \, mod \, 26$
		- $p = D(c) = (p- k) \, mod \, 26$
		- 카이사르(시프트 3): `HELLO → KHOOR`
	    - **약점**:
		    - 문자 빈도(**빈도 분석**)로 쉽게 깨짐
			- 가능한 키가 26개뿐이라 **브루트포스**로 쉽게 깨진다.
- **동형 치환(Homophonic)**: 자주 나오는 글자에 여러 기호를 할당해 빈도 흔적을 줄임
- **다중 알파벳(폴리알파벳)**: 위치에 따라 치환표가 바뀜
    - 예) 비제네르(Vigenère)
- **다문자(블록) 치환(Poly-graphic)**: 글자 **여러 개를 묶어서** 한 번에 치환
    - 예) 플레이페어(Playfair), 힐(Hill) 암호
- **비트 단위 치환(S-box)**: n비트 입력을 비선형으로 n비트 출력으로 매핑
    - 현대 블록암호(AES 등)에서 **혼돈(confusion)**을 제공

### 2.4. 전치 암호와의 차이

- **치환**: **기호 자체를 다른 값으로 바꿈**
- **전치(Transposition)**: 기호의 **순서만 섞음**, 기호 자체는 그대로

## 3. Crypto Analysis
### 3.1. 목표

- **비밀키/평문**을 알아내거나
- **암호 설계·구현의 약점**을 찾아 **실질적 보안성**을 무너뜨리는 것

### 3.2. 공격 가정(데이터 접근 수준)

- **Ciphertext-Only Attack (COA)**: 암문만 공격, 암호문만 있음 → 빈도/통계 분석(고전암호)
	- ![](2025-10-21-19-33-34.jpg)
- **Known-Plaintext Attack (KPA)**: 기지 평문 공격, 일부 평문–암호문 쌍을 앎
	- ![](../../_image/2025-10-21-19-34-02.jpg)
- **Chosen-Plaintext Attack (CPA)**: 선택 평문 공격, 임의 평문을 암호화 → 블록암호 분석에 강력
	- ![](../../_image/2025-10-21-19-34-04.jpg)
- **Chosen-Ciphertext Attack (CCA)**: 선택 암문 공격, 임의 암호문을 복호화 → 패딩 오라클 등
	- ![](../../_image/2025-10-21-19-34-07.jpg)

> 현대 보안 목표: 보통 **IND-CPA**(스트림/블록 암호 모드)나 **IND-CCA**(암호화+MAC 또는 AEAD) 충족.

### 3.3. 대표 공격 기법
#### 3.3.1. 고전/기초

- **빈도 분석**: 모노알파벳 치환 붕괴
- **Kasiski/Index of Coincidence**: 비제네르 키 길이 추정
- **브루트포스/키 공간 탐색**: 키 길이 짧으면 파괴

#### 3.3.2. 현대 블록암호/스트림암호

- **선형 분석(Linear)**, **차분 분석(Differential)**: S-box·라운드 구조의 통계적 편향 이용
- **중간만남(Meet-in-the-middle)**: 다중 라운드/더블 암호
- **슬라이드/상관 공격, 불비성(algebraic) 공격**: 구조적 반복·대수 표현 노림
- **Nonce/IV 오용**(스트림/CTR): 같은 키·논스로 두 번 암호화 → XOR로 평문 관계 노출
- **패딩 오라클**: CBC+잘못된 에러 처리 → 바이트 단위 평문 복구
- **사이드 채널**: 시간/전력/EM/캐시 → 키 누출
- **결함 주입(Fault)**: 오류 유발 후 차이로 키 추정
- **랜덤성 취약**: 예측 가능 PRNG → 키/nonce 노출

#### 3.3.3. 해시/무결성

- **충돌 공격**(MD5/SHA-1): 서로 다른 메시지로 같은 해시
- **길이 확장 공격**: Merkle–Damgård 구조를 모르면 실수
- **Joux/MITM**: 다중-블록 구성 취약성

### 3.4. 설계·안전성 개념

- **Kerckhoffs 원칙**: 알고리즘은 공개, **비밀은 키만**
- **혼돈/확산(Shannon)**: S-box(혼돈) + 퍼뮤테이션/선형층(확산)
- **Avalanche 효과**: 입력 1비트 변화 → 출력 절반 이상 변화
- **Unicity distance**: 통계적으로 유일 키가 결정되는 최소 데이터량
- **감사·증명**: 축소판 공격 한계, 감쇠 계수, **감사된 표준(AES, SHA-2/3, ChaCha20-Poly1305)** 사용

## 4. 일회용 패드(One Time Pad, OTP)

- 어떤 평문이 있을 때, 평문과 길이가 같은 임의의 Key(Seed)를 XOR 연산으로 암호문을 생성하는 암호 체계이다.
- 메시지 길이만큼의 **진정한 난수 키**를 **한 번만 쓰면** **정보론적으로 안전**하다. → 기밀성
- 문제: 키 생성·분배가 현실적으로 어려움.
- XOR 예시로 암·복호가 성립(A⊕B⊕A=B).
```
m = 					 1110100 1110010
OTP = 					 0011010 1101101
E(m) = m ⊕ OTP = 		1101110 0011111
D(E(m)) = E(m) ⊕ OTP = 	1110100 1110010
```

> 참고
> [One Time Password, OTPassword](One%20Time%20Password.md)

## 5. Block Cipher V.S. Streaming Cipher
### 5.1. Block Cipher

- 블록 단위 암호화
- 마지막 블록에서는 패딩 처리
- 종류: DES, AES

### 5.2. Streaming Cipher

![](2025-10-13-13-38-03.png)

- 바이트 단위 암호화
- 스트림키를 생성해 **XOR**로 처리($C_i=M_i⊕StreamKey_i$).
- 좋은 설계는 긴 주기·통계적 무작위성·충분한 키 길이를 가진다.
- 종류: RC4

## 6. Data Encryption Standard, DES
### 6.1. 정의

- 1977년 미국 표준으로 채택된 **대칭키 블록 암호**.
- **블록 크기 64비트**, **키 길이 56비트**(8비트 패리티 제외).
- 오늘날엔 **키가 짧아** 브루트포스로 깨질 수 있어 **사용 권장되지 않음**

### 6.2. 구조

![](../../_image/2025-10-21-17-09-47.jpg)

- **Feistel 네트워크 16라운드**
    1. 초기 치환(IP)
	    1. ![](../../_image/2025-10-21-19-47-07.jpg)
    2. 좌/우 32비트로 분할
    3. 라운드 함수 **F**: 확장(E, 32→48) → **서브키와 XOR** → **S-box 8개**(6비트→4비트 비선형 치환) → P-박스(확산)
	    1. DES Round: ![DES ROUND](../../_image/2025-10-21-17-11-00.jpg)
			> Feistel Cipher 구조
	    2. Mangler Function: ![Mangler Function](../../_image/2025-10-21-19-48-26.jpg)
	    3. Subkey Generation Function: ![Subkey Generation Function](../../_image/2025-10-21-19-48-42.jpg)
    5. 좌우 스왑, 16라운드 반복
    6. 최종 치환(IP⁻¹)
	    1. ![](../../_image/2025-10-21-19-47-12.jpg)
- **키 스케줄**: 56비트를 PC-1로 분리(C,D) → 라운드마다 순환이동 → PC-2로 48비트 **서브키** 생성.

## 7. 운용 모드(Modes of Operation) 와 패딩
### 7.1. Electronic Code Book, ECB

![](../../_image/2025-10-21-17-12-43.jpg)
![|556x225](../../_image/2025-10-21-17-12-48.jpg)

블록마다 독립 암호화
- 장점: 단순·병렬화 용이, 블록 손실/손상에 견고함
- 단점: **패턴 누출**(이미지/문서 부적합).
	- ![](../../_image/2025-10-21-17-13-22.jpg)

### 7.2. Cipher Block Chaining, CBC
#### 7.2.1. 목적

블록 암호(AES, 3DES 등)를 이용해 **패턴 노출(ECB의 단점)** 을 막기 위해 각 블록을 **이전 암문과 연쇄**시켜 암호화합니다.

#### 7.2.2. 동작식

블록 크기를 `n`이라 하고, `IV`(초기화 벡터), 키 `K`, 평문 블록 `P_i`, 암문 블록 `C_i`라면:
- **암호화**
	- ![](../../_image/2025-10-21-17-14-43.jpg)
    - $C_0 = E_K(P_0 ⊕ IV)$
    - $C_i = E_K(Pi ⊕ C_{i-1}) (i ≥ 1)$
- <font color="#ff0000">복호화</font>
	- ![](../../_image/2025-10-21-17-14-46.jpg)
    - $P_0 = D_K(C_0) ⊕ IV$
    - $P_i = D_K(C_i) ⊕ C_{i-1}$

> `IV`와 $C_{i-1}$가 **사전 가림(mask)** 역할을 하여 같은 `P`라도 다른 결과가 나옵니다.

#### 7.2.3. IV(초기화 벡터)

- **길이**: 블록 크기와 동일(예: AES는 16바이트).
- **요구사항**: **매번 새롭고 예측 불가**(random)해야 함.
    - 재사용 또는 예측 가능 IV → 첫 블록 정보 누출/공격(예: TLS 1.0의 CBC 관련 이슈).
- **전달**: 보통 암문 앞에 **평문으로 붙여 전송**(비밀 아님). 단, **무결성 보호**는 별도로 해야 함.

#### 7.2.4. 패딩

![](../../_image/2025-10-21-19-26-46.jpg)

- 평문 길이가 블록 크기의 배수가 아니면 **PKCS#7** 등으로 패딩.
- **주의**: 패딩 오류 메시지를 구분해 주면 **패딩 오라클 공격**에 취약 → 오류 응답을 **동일하게** 처리(상수시간), 혹은 **AEAD** 사용 권장.
- **PKCS#5 패딩**: “추가 바이트 수” 값을 그 개수만큼 채움(1~8바이트).
	- 예: `길이 mod 8 == 7` → PM = M + `0x01`
	- 예: `길이 mod 8 == 6` → PM = M + `0x0202`
	- 예: `길이 mod 8 == 5` → PM = M + `0x030303
	- 예: `길이 mod 8 == 0` → PM = M + `0x0808080808080808`

#### 7.2.5. 오류·변조 전파

- $C_i$의 한 비트가 뒤틀리면:
    - $P_i$ 전체 블록이 **무작위화**
    - $P_{i+1}$의 **동일 비트가 뒤집힘**(1비트 영향)
- **무결성 없음**: 공격자가 $C$를 바꾸면 $P$도 **예측 가능하게 바뀔 수 있음(가변성)**.  
    → **Encrypt-then-MAC(HMAC)** 또는 **AEAD(AES-GCM, ChaCha20-Poly1305)** 사용이 실무 표준.

#### 7.2.6. Message Authentication Code, MAC

![](../../_image/2025-10-21-19-24-48.jpg)

- **CBC-MAC에서의 residue**: CBC 방식으로 블록암호를 체이닝했을 때 **마지막 블록(최종 체이닝 값)** 을 가리킵니다. 이 값을 그대로(또는 변환·절단 후) **MAC 태그**로 사용한다.
- **정의(길이 = 블록 크기 n)**
    - $C_0=E_K(P_0⊕IV)C_0 = E_K(P_0 \oplus IV)C_0​=E_K​(P_0​⊕IV)$
    - $C_i=E_K(P_i⊕C_{i−1})C_i = E_K(P_i \oplus C_{i-1})Ci​=E_K​(P_i​⊕C_{i−1}​)$
    - **$residue = C_{m-1}$​** (마지막 블록) → 필요시 **truncation** 또는 **출력 변환**(예: 3DES 한 번 더 암호화) 후 사용
- **주의점**
    - **가변 길이 메시지**에 그대로 CBC-MAC을 쓰면 취약 → **길이 바인딩**(길이 포함, 도메인 구분) 또는 **CMAC** 같은 표준을 사용
    - 태그 비교는 **상수시간**으로 하고, 직렬화/인코딩을 고정(정규화)

> [Message Authentication Code MAC](Message%20Authentication%20Code%20MAC.md)

#### 7.2.6. 성능·병렬성

- **암호화**: $C_{i-1}$이 필요 → **병렬화 어려움**
- **복호화**: $D_K(C_i)$는 각 블록 독립적으로 가능 → **병렬화 가능**(이후 $⊕ C_{i-1}$)

## 8. Triple DES

![](2025-10-13-12-50-56.png)

- **DES**를 세 번 적용해 보안을 강화한 **대칭키 블록 암호**(블록 크기 64비트).
- 두 키만으로도 구현
	- Key Size: 128 bits → 112 bits
- $C = E(k1) → D(k2) → E(k1)$
- $P = D(k1) → E(k2) → D(k1)$
- DES 약점을 보완하지만 느림.

## 9. Advanced Encryption Standard, AES

![](../../_image/2025-10-21-19-26-20.jpg)

### 9.1. 정의

- **대칭키 블록 암호** 표준(NIST).
- **블록 크기: 128비트** 고정.
- **키 길이:** 128/192/256비트 → **라운드 수:** 10/12/14.

### 9.2. 구조

- **SPN 구조**(Substitution–Permutation Network).
- 한 라운드 = **SubBytes(S-box)** → **ShiftRows** → **MixColumns** → **AddRoundKey**  
    (마지막 라운드는 MixColumns 없음)
- **키 스케줄**: 원키에서 라운드 키들을 생성.

## 10. RC4
### 10.1. 정의

- 1987년 Ron Rivest가 설계한 **키스트림 생성형 스트림 암호**.
- 내부 상태: 길이 256의 **바이트 퍼뮤테이션 배열 S**, 인덱스 **i, j**.
- 두 단계:
    1. **KSA**(Key Scheduling): 키로 S 초기화
    2. **PRGA**(Pseudo-Random Generation): 바이트 단위 키스트림 생성 → 평문과 XOR
	    - ![](../../_image/2025-10-21-19-50-51.png)

### 장점

- 매우 단순하고 빠름(바이트 연산 위주, 메모리 256B).
- 과거에 WEP, WPA-TKIP, SSL/TLS 등에서 널리 사용.

### 약점

- **초기 바이어스**(처음 수십~수백 바이트가 통계적 편향) → 같은 키/유사 키로 여러 패킷 암호화 시 정보 새어 나옴.
- **KSA 약점**: 키와 초기 키스트림 간 상관(예: **FMS** 공격) → **WEP 완전 붕괴**.
- **TLS의 RC4도 취약**: 다량의 세션/요청 수집 시 평문 일부 회복(**RC4 NOMORE**, 2015).  
    → **RFC 7465**: TLS에서 RC4 **전면 금지**.
- **WPA-TKIP/RC4**: 설계상 완화책이 있었지만 현재는 **비권장/폐기 수순**.

---

# 참고

- [NAVER: DES(Data Encryption Standard)](https://m.blog.naver.com/wnrjsxo/221708511553)
- [NAVER: AES(Advanced Encryption Standard)](https://blog.naver.com/PostView.naver?blogId=wnrjsxo&logNo=221711255389)
- [Wikipedia: OTPassword](https://ko.wikipedia.org/wiki/%EC%9D%BC%ED%9A%8C%EC%9A%A9_%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8)