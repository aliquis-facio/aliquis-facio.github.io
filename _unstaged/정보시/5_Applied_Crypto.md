## 1. 시크릿 셰어링(Secret Sharing)

- 목적: 하나의 비밀 S를 n명의 참여자에게 **조각(share)** 으로 나눠 주고, **k개 이상** 모여야만 원래 비밀을 복원할 수 있게 하는 **(k, n) 임계값(threshold) 스킴**. 개별 조각 단독으론 아무 쓸모가 없으므로 단일 실패 지점을 제거한다.
- 샤미르(Shamir) 방식: 비밀 S를 상수항 a₀=S로 갖는 **차수 k−1 다항식 f(x)** 를 만들고, 각 참여자에게 **점 (i, f(i))** 을 배포. 임의의 k개 점으로 보간하면 a₀=S를 복원할 수 있다.
- 예시:
	1. S=1234, n=6, k=3
	2. 임의의 값 선택 $(a₁, a₂)=(166, 94)$ → $f(x) = 1234 + 166x + 94x^2$
	3. 점들 (1,1494), (2,1942), (3,2598), (4,3402), (5,4414), (6,5614) 배포
	4. **어떤 3점**만 있어도 S를 복원 가능.

## 2. 블라인드 서명(Blind Signatures)

- 개념: 서명자(Bob)가 **메시지 내용을 보지 못한 채** 서명해 주도록 하는 기법(Chaum, RSA 기반). 발신자(Alice)가 임의 난수 k를 뽑아 메시지를 **블라인딩**하고, Bob은 이를 서명한 뒤 Alice가 **언블라인딩**하여 최종 서명을 얻는다.
- 수식(RSA): t = m·kᵉ (mod n) → Bob: tᵈ = mᵈ·k (mod n) → Alice: (tᵈ·k⁻¹) = mᵈ (mod n).
- 활용: **전자투표** 등 발신자 프라이버시가 중요한 환경(투표 인증은 하되, 선택 내용은 노출 금지).

## 3. Kerberos

# Ch.5 보조자료 – 전자결제(Payment Systems)

## 1) 전자결제 기본 구조

- **다자간 프로토콜**: 고객(Payer), 상인(Payee), 은행(Bank)이 참여. 전자 화폐(coin)는 **고정 가치의 전자 토큰**으로 모델링됨.
- **거래 단계**: (1) 고객의 **인출(Withdrawal)** → (2) 고객의 **지불(Payment)** → (3) 상인의 **입금(Deposit)**.
- **온라인/오프라인**: 온라인은 **은행이 실시간 개입**해 이중지불 차단, 오프라인은 거래 시 은행 불참여(다른 방식으로 이중지불 탐지).

## 2) 목표(보안/프라이버시)

- **무결성**: 위조 불가, 유효 코인만 정산.
- **책임성(부인방지)**: 사후 분쟁 해결 가능, 거래 부인 어렵게.
- **프라이버시**: 당사자 신원/연결성 최소 공개(**트레이서빌리티 축소**).

## 3) 기본 디지털 서명형 전자현금

- 코인은 **은행 서명**이 붙은 무작위 식별자. 상인은 은행 서명을 검증하고, 은행은 **서명 검증 코인만 입금** 처리.
- 한계: 고객이 **복사(이중지불)** 할 수 있고, **은행이 모든 거래 내역을 알게 됨**(프라이버시 약함).

## 4) 블라인드 서명 기반 “프라이빗 결제”

- **블라인드 서명(Chaum)**: 은행이 **내용을 보지 못한 채** 코인에 서명 → 은행은 코인-고객 연결을 모름(언링커빌리티).
- **RSA 블라인드 서명 요지**
    - 고객: 무작위 r 선택, ($y = r^e \cdot h(x) \bmod N$) 전송.
    - 은행: ( $\sigma(y)=y^d \bmod N$) 반환.
    - 고객: 언블라인딩 ( $\sigma(x)=\sigma(y)\cdot r^{-1} \equiv h(x)^d \bmod N$)로 유효 서명 획득.
- **유효 코인만 서명**받게 하는 절차(컷앤초즈): k개의 코인을 제출하면 은행이 **k−1개 무작위 개봉 검사**, 나머지 1개를 블라인드 서명 → **유효일 확률 (1-1/k)**.
    

## 5) 이중지불(더블스펜딩) 대응

- **온라인**: 은행이 실시간 중복 체크로 즉시 차단.
- **오프라인**: 코인에 **암호화된 고객/상인 신원 조각**을 내장해, 동일 코인이 두 번 쓰이면 **사기 당사자 신원 복구**(탐지·추적형).

## 6) 신원 은닉과 검출을 위한 해시 커밋·분할

- **비밀 분할(XOR)**: (x = y \oplus z). 단독 조각(y 또는 z)만으로는 **정보 누설 0**.
- **커밋 쌍**: (a=h(y),; b=h(z)). 코인은 **식별자 x**와 **커밋 쌍 (a_i,b_i)_{i=1..n}** 벡터로 구성 → 코인 자체는 고객 신원 비공개.
- **지불 시**: 고객이 **선택 벡터** (s_1..s_n) 제시, 각 (s_i)에 따라 (h(P_i)=a_i) 또는 (b_i)가 되도록 **해시 프리이미지 (P_i)** 공개(검증 가능).
- **입금/탐지 성질**: 서로 다른 두 상인이 **같은 선택 벡터**를 받을 확률은 (1/2^n) → **이중지불 시 고객 신원 복원 확률 (1-1/2^n)**. 상인이 들키지 않고 이중지불하려면 **해시 충돌**을 찾아야 함(현실적으로 어려움).

---

### 한 장 암기 포인트

- **블라인드 서명**: (y=r^e h(x) \xrightarrow{\text{sign}} y^d \Rightarrow (y^d r^{-1})=h(x)^d). 은행은 **누구의 코인인지 모름**.
- **컷앤초즈 보증**: 유효 코인 서명 확률 (1-1/k).
- **오프라인 이중지불 탐지**: 선택 벡터/커밋 공개 조각으로 **사기자 식별 확률 (1-1/2^n)**.
- **XOR 분할 & 해시 커밋**: **프라이버시 보장 + 사후 추적 가능성**의 균형.