# Logging & Alerting Failures
## 1. 배경 (Background)

- **순위 변화 / 위치**
    - 2021에서 A09였고, 2025 RC1에서도 그대로 **#9 유지**. 
- **이름 변경 포인트**
    - 기존: _Security Logging and Monitoring Failures_
    - 2025: _Logging & Alerting Failures_  
        → 단순히 “로그 남겼다”에서 끝이 아니라,  
        **“알림(alerting)이 실제 대응을 유도해야 한다”** b는 점을 강조하기 위해 이름이 정리됨. 
- **데이터 상 특징**
    - CVE/CVSS 데이터에서는 **상대적으로 적게 나타나는 편(723 CVEs)** 이라 “언더리포트(underrepresented)” 카테고리로 언급됨.
    - 그럼에도 불구하고, **침해 탐지·대응·포렌식에서 엄청나게 중요한 역할**을 해서, 커뮤니티 설문에서 세 번째 연속으로 Top 10 안에 들어감. 
- **대표 CWE**
    - CWE-117: 로그용 출력 인코딩 처리 실패
    - CWE-532: 로그 파일에 민감한 정보 삽입
    - CWE-778: 로깅 부족 등 “로그를 안 남김, 잘못 남김, 위험하게 남김”을 다 포함하는 카테고리. 

## 2. 점수표 (Score table)

|항목|값|
|---|---|
|매핑된 CWE 개수|5|
|최대 발생률(Max Incidence)|11.33%|
|평균 발생률(Avg Incidence)|3.91%|
|최대 커버리지(Max Coverage)|85.96%|
|평균 커버리지(Avg Coverage)|46.48%|
|가중 Exploit 점수 평균|7.19|
|가중 Impact 점수 평균|2.65|
|총 발생 건수|260,288|
|관련 CVE 개수|723|

**해석 포인트**

- 분석된 애플리케이션의 **평균 3.91%** 가 로그/알림 관련 문제를 최소 1개 포함.
- Exploit 점수는 높은 편(7.19)이지만, Impact 점수가 상대적으로 낮은 이유: 많은 경우 이 취약점 자체가 직접 시스템을 뚫는다기보다는, **다른 공격을 탐지·대응 못 하게 만들어 피해를 키우는 “가속기” 역할**을 하기 때문.

## 3. 설명 (Description)
### 3-1. 어떤 취약점인가?

> **공격/오류를 로그·모니터링·알림으로 제대로 포착·전달하지 못해서,  
> 침해를 제때 발견/대응할 수 없게 만드는 모든 문제**를 묶은 카테고리. 

- 로그인/로그인 실패/고가치 트랜잭션 같은 **감사 대상 이벤트가 누락되거나, 들쭉날쭉 기록**될 때
    - 예: 성공한 로그인만 로그, 실패한 로그인은 로그 X 
- 경고·에러가 발생해도
    - 로그를 아예 안 남기거나,
    - 의미를 알 수 없는 애매한 메시지만 찍는 경우
        
- **로그 무결성 보호 실패**
    
    - 공격자가 로그를 삭제/수정할 수 있는 구조
        
- 앱/API 로그를 **실시간/주기적으로 모니터링하지 않음**
    
- 로그를 **로컬에만 저장**하고 백업/중앙 수집이 없어, 장애나 침해 시 포렌식 불가
    
- **알림 임계값/에스컬레이션 프로세스 미비**
    
    - 알림이 제대로 설정 안 되거나,
        
    - SOC/운영팀이 알림을 제때 보지 못함 
        
- DAST/침투테스트(Burp, ZAP 등)에서 뻔히 공격 패턴이 발생하는데도  
    **어떠한 알림도 울리지 않는 상황**
    
- 애플리케이션이 **실시간/근실시간으로 공격을 탐지·상향 보고·알림**할 수 없는 상태
    
- **로그와 알림이 오히려 정보 유출/공격 표면**이 되는 경우: 
    
    - 사용자/공격자에게 내부 예외 메시지, 스택 트레이스 등 상세 정보 노출 (A01 Broken Access Control과도 연계)
        
    - PII/PHI 등 민감 정보를 그대로 로그에 남김
        
    - 로그에 제대로 인코딩하지 않아 **로그 시스템 대상으로 Injection**이 가능한 경우
        
- 오류/예외 상황을 아예 처리하지 않거나 잘못 처리해서,
    
    - 시스템 입장에서는 **“아무 문제 없는 것처럼” 보이는 상태가 되어 로그도 없음**
        
- **알림 use case**가 부족하거나 오래되어,  
    새로운 공격 패턴을 제대로 인식하지 못함
    
- **False Positive(오탐)**가 너무 많아서,
    
    - 중요한 알림과 중요하지 않은 알림을 구별할 수 없고,
        
    - SOC 팀이 경고 피로(alert fatigue)에 빠지는 상황
        
- 탐지된 알림을 처리할 **플레이북이 부실하거나 없음** →  
    알람은 울렸는데 아무도 “그 다음에 뭘 해야 하는지” 모름 
    

---

## 4. 예방 방법 (How to prevent)

OWASP가 제안하는 통제들을 핵심만 추려서 정리하면:

1. **보안 관련 이벤트는 반드시 로그로 남기기**
    
    - 로그인/로그아웃, 로그인 실패,  
        접근 제어 실패, 서버 측 입력 검증 실패 등  
        **보안 통제가 있는 부분은 성공/실패 모두 로그**로 기록. 
        
    - 로그에는 **사용자 컨텍스트**(ID, 세션 ID, IP, User-Agent 등)를 포함해  
        나중에 **포렌식·추적**이 가능하게 한다.
        
2. **표준화된 로그 포맷 사용**
    
    - SIEM/로그 관리 솔루션이 **자동으로 파싱·검색**하기 쉬운 형식(JSON, 공통 스키마 등) 사용. 
        
3. **로그 데이터 인코딩/중립화**
    
    - 로그에 들어가는 데이터는 **출력 중립화(encoding)**를 적용해  
        로깅/모니터링 시스템을 향한 **Injection 공격(CWE-117)**을 방지. 
        
4. **무결성 보호가 있는 감사 추적(Audit Trail)**
    
    - 중요한 트랜잭션에 대해서는
        
        - **append-only 테이블**,
            
        - WORM 스토리지 등  
            **수정·삭제가 어려운 구조**로 무결성 보호. 
            
5. **에러 발생 시 롤백 & Fail Closed**
    
    - 트랜잭션 도중 에러가 발생하면
        
        - 상태를 적절히 롤백하고,
            
        - “열린 상태로” 남지 않도록 **항상 Fail Closed**하게 설계. 
            
6. **수상한 행동 시 알림 발행**
    
    - “언제 알림을 쏠지”에 대한 **개발자 가이드/정책**을 만들고,
        
        - 비정상 로그인 시도,
            
        - 특정 액션의 과도한 반복,
            
        - 데이터 대량 조회/다운로드 등  
            사용 패턴 기준으로 **알림 use case 정의**. 
            
7. **DevSecOps + SOC 연계 운영**
    
    - DevSecOps/보안팀이 협력해서
        
        - **모니터링/알림 use case + 플레이북**을 만들고,
            
        - SOC에서 **빠르게 탐지·대응**할 수 있도록 절차를 정리. 
            
8. **Honeytoken 도입**
    
    - 평소 비즈니스에서는 절대 접근하지 않는  
        **가짜 계정/데이터/레코드(honeytoken)**를 심어두고,  
        그 값에 접근이 발생하면 **거의 0에 가까운 오탐률로 공격 탐지**. 
        
9. **행위 분석 + AI 활용(옵션)**
    
    - 사용자/시스템 행위를 분석하는 **Behavior Analytics**와  
        **AI 기반 이상 탐지**를 추가해  
        오탐을 줄이고 탐지 품질을 높일 수 있음. 
        
10. **사고 대응/복구 계획 수립**
    
    - NIST SP 800-61r2 같은 **Incident Response 가이드**를 참고해  
        조직 차원의 **사고 대응/복구 플랜** 수립. 
        
    - 개발자에게도 **어떤 패턴이 공격/사고 징후인지 교육**해서,  
        이상 행동을 발견하면 즉시 보고하도록 만든다.
        
11. **도구 활용**
    
    - 예:
        
        - WAF + ModSecurity Core Rule Set,
            
        - ELK Stack(Elasticsearch, Logstash, Kibana) 기반 로그 수집/대시보드/알림,
            
        - 상용 Observability/SIEM 툴 등. 
            

---

## 5. 예시 공격 시나리오 (Example attack scenarios)

### 시나리오 #1 – 어린이 건강보험 웹사이트의 7년짜리 침해

- 한 **어린이 건강보험 제공자**의 웹사이트가 공격을 받았는데,
    
    - **모니터링과 로깅이 거의 없어** 내부에서는 아무도 모름. 
        
- 외부 제3자가 “너희 시스템 해킹당한 것 같은데?” 하고 알려주기 전까지
    
    - 공격자는 **수백만 명(3.5M+) 아동의 민감한 건강 기록**을 열람·수정.
        
- 사고 후 포렌식에서 드러난 사실:
    
    - 개발 단계에서부터 **중요 취약점과 로깅/모니터링 이슈**를 전혀 해결하지 않았고,
        
    - 침해는 **2013년부터 7년 넘게 계속되었을 가능성**이 있음. 
        

→ 공격 그 자체도 문제지만, **“7년 동안 몰랐다는 것”**이 바로 A09 카테고리의 핵심.

---

### 시나리오 #2 – 인도 항공사, 10년치 승객 데이터 유출

- 어느 **인도 대형 항공사**가
    
    - 서드파티 클라우드 호스팅 업체를 사용 중이었는데,
        
    - 거기서 **10년 넘는 기간의 승객 데이터(여권, 카드 정보 포함)**가 유출. 
        
- 클라우드 업체가 나중에야 침해 사실을 인지하고 항공사에 통보.
    
- 만약 항공사/서드파티 모두
    
    - 충분한 **로그·모니터링·알림 체계**를 갖추고 있었다면,
        
    - 공격 시점에 훨씬 더 빠르게 탐지·차단·피해 축소가 가능했을 것.
        

---

### 시나리오 #3 – 유럽 항공사의 결제 앱 침해 & GDPR 벌금

- 한 **유럽 항공사**의 결제 애플리케이션 취약점이 악용되어,  
    공격자가 **40만+ 건의 고객 결제 정보를 수집**. 
    
- 침해 탐지 및 보고 지연, 모니터링 부족 등의 이유로  
    GDPR 위반이 인정되어 **2,000만 파운드 벌금**이 부과됨.
    
- 여기서도 공격 자체는 다른 A항목(예: Injection, Broken Access Control)에 해당하지만,  
    **공격을 빨리 감지하지 못하고, 알림/대응 프로세스가 부실했다는 점**이 A09의 핵심 이슈.
    

---

정리하면, A09는:

- **“공격을 막는 기술”이 아니라, “공격이 일어났을 때 눈치라도 채는 기술·프로세스”**에 대한 항목이고,
    
- 로그/모니터링/알림 체계가 부실하면
    
    - 다른 모든 보안 통제가 뚫렸을 때 **마지막 방어선**이 사라지는 것과 같아요.
        

필요하면, 이전 A04~A08처럼  
**배경 / 점수표 / 설명 / 예방 / 시나리오** 구조 그대로 보고서/발표용 템플릿으로 묶어서 정리해 줄게요.