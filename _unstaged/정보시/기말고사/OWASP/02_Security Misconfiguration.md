# Misconfiguration 
## 1. 배경 (Background)

- 이전 OWASP Top 10에서 5위였던 항목이 **2위로 상승**.
- **테스트된 애플리케이션 100%** 에서 어떤 형태로든 설정 오류(misconfiguration)가 발견됨.
- 평균 발생률은 **3.00%**, 관련 CWE(취약점 분류) 발생은 **약 71만 9천 건**, 관련 CVE도 다수.
- 최근 소프트웨어와 클라우드 서비스가 점점 더 **“설정으로 모든 걸 조정하는 구조”** 가 되면서, 잘못된 설정이 치명적인 보안 리스크로 이어지는 경우가 많아짐.
- 대표적인 관련 CWE:
    - **CWE-16 Configuration**
    - **CWE-611 XML External Entity(XXE) 설정 문제

## 2. 정의 (Description)

**Security Misconfiguration**이란, 시스템, 애플리케이션, 클라우드 서비스 등이 **보안 관점에서 안전하지 않게 설정된 상태**를 의미함. 
애플리케이션이 다음과 같은 경우 취약할 수 있음:
1. **적절한 하드닝 부족**
    - 인프라/애플리케이션 스택 어느 구간이든 보안 하드닝이 되어 있지 않거나, 클라우드 서비스 권한 설정이 잘못된 경우.
2. **불필요한 기능이 활성화**
    - 사용하지 않는 포트, 서비스, 테스트 페이지, 샘플 앱, 계정, 과도한 권한 등이 남아 있음.
3. **기본 계정/기본 비밀번호 사용**
    - 설치 시 제공되는 기본 계정과 기본 패스워드를 그대로 사용.
4. **오류 처리 미흡**
    - 에러 시 스택 트레이스, 내부 경로, 버전 정보 등 **너무 상세한 오류 메시지**가 사용자에게 그대로 노출됨.
5. **업그레이드 후 보안 기능 미사용
    - 시스템을 업그레이드했는데, 새로 제공된 보안 옵션을 켜지 않거나 기본값으로 둠.
6. **하위 호환성만 과도하게 고려**
    - 오래된 클라이언트/시스템을 위해 구식·취약한 설정을 그대로 유지.
7. **서버/프레임워크/라이브러리/DB 보안 설정 미비**
    - 예: Struts, Spring, ASP.NET, 데이터베이스 등의 보안 관련 설정값을 강화하지 않음.
8. **보안 헤더 미설정**
    - HTTP Security Header를 보내지 않거나, 안전하지 않은 값으로 설정.

## 3. 예방 방법 (How to prevent)

**핵심 키워드: “반복 가능하고 자동화된 하드닝 프로세스”** 
1. **반복 가능한 하드닝 프로세스**
    - 개발 / QA / 운영 환경을 **동일한 보안 기준**으로 구성.
    - 다만 각 환경은 **서로 다른 계정/비밀번호** 사용.
    - 새 환경을 빠르게, 그리고 안전하게 만들 수 있도록 **자동화 스크립트/코드화(IaC)** 활용.
2. **최소 기능 원칙 (Minimal Platform)**
    - 사용하지 않는 기능, 모듈, 문서, 샘플 앱은 **설치하지 않거나 제거**.
    - 테스트/샘플 페이지는 운영 환경에서 반드시 제거.
3. **패치 관리 & 설정 리뷰**
    - 보안 공지, 업데이트, 패치에 맞춰 **설정값도 함께 점검**.
    - 클라우드 스토리지 권한(S3 bucket 등)을 정기적으로 검토.
4. **네트워크 / 아키텍처 분리**
    - 세그멘테이션, 컨테이너, 보안 그룹(ACL) 등으로 **컴포넌트/테넌트 분리**.
5. **클라이언트로 보안 지시 전달**
    - 예: 적절한 Security Header 전송 (HSTS, X-Content-Type-Options 등).
6. **설정 검증 자동화**
    - 모든 환경에서 **설정이 제대로 적용됐는지 자동 검증**하는 프로세스 구축.
    - 자동화가 어렵다면 최소한 **연 1회 이상 수동 점검** 수행.
7. **오류 메시지 중앙 관리**
    - 과도한 에러 메시지가 사용자에게 노출되지 않도록 **중앙 집중식 에러 처리** 추가(백업 장치 개념).

## 4. 공격 시나리오 예시 (Example attack scenarios)

1. **샘플 애플리케이션 미삭제**
    - 운영 서버에 샘플 앱/테스트 페이지가 그대로 존재.
    - 샘플 앱에 알려진 취약점이 있어 이를 통해 서버 장악.
    - 심지어 **관리 콘솔** 샘플이 있고, 기본 계정/비밀번호가 그대로라면 공격자는 바로 로그인 후 서버 접수.
2. **디렉터리 리스팅 활성화**
    - 웹 서버에서 디렉터리 listing 이 비활성화되지 않음.
    - 공격자가 디렉터리 목록을 열람 → 컴파일된 .class 파일 다운로드 → 디컴파일 → 소스 분석 후 심각한 접근 통제 취약점 발견.
3. **상세 에러 메시지 노출**
    - 서버 설정 상, 스택 트레이스 등 상세 에러가 사용자에게 그대로 반환.
    - 민감 정보(경로, 설정, 버전 등)와 알려진 취약 버전 정보가 노출되어 후속 공격에 활용됨.
4. **클라우드 스토리지 권한 오픈**
    - CSP(Cloud Service Provider)의 기본 설정이 인터넷 전체에 공유 가능하도록 열려 있음.
    - 그 상태로 민감 데이터가 저장된 버킷/스토리지가 외부에서 그대로 접근 가능.