# Security Misconfiguration
## 1. 배경 (Background)

- **순위**: OWASP Top 10:2025에서 A02는 2021년 **5위에서 2위로 상승**.
- **발견 비율**: 테스트된 애플리케이션 **100%에서 어떤 형태로든 보안 설정 오류가 관찰**되었고, 평균 발생률은 **3.00%**, 이 범주에 매핑된 CWE 발생 건수는 **약 71만 9천 건** 수준.
- **상승 배경**: 현대 애플리케이션은 소스 코드뿐 아니라 **설정 파일, 클라우드 권한, 인프라 템플릿** 등을 통해 동작이 결정되는 비율이 크게 증가했고, 이 과정에서 잘못된 설정(과도한 권한, 기본값 방치 등)이 매우 흔하게 발생.
- **대표 CWE** (A02 범주에 포함되는 대표적인 약점들):
    - **CWE-16** – Configuration (보안에 취약한 전반적 설정 문제)
    - **CWE-611** – Improper Restriction of XML External Entity Reference (XXE)
    - **CWE-614** – Sensitive Cookie in HTTPS Session Without 'Secure' Attribute
    - **CWE-1004** – Sensitive Cookie Without 'HttpOnly' Flag
    - **CWE-260** – Password in Configuration File



## 2. Score table (점수 표)

|항목|값|
|---|---|
|매핑된 CWE 수|16|
|최대 발생률 (Max Incidence)|27.70%|
|평균 발생률 (Avg Incidence)|3.00%|
|최대 커버리지 (Max Coverage)|100.00%|
|평균 커버리지 (Avg Coverage)|52.35%|
|가중 평균 Exploit 점수|7.96|
|가중 평균 Impact 점수|3.97|
|총 발생 건수|719,084|
|총 CVE 수|1,375|

정량 지표를 종합하면, **Security Misconfiguration은 모든 애플리케이션에서 관찰될 정도로 범위가 넓고, 공격자가 악용하기도 쉽고(Exploit 점수 높음), 실제 영향도(Impact)도 상당히 큰 핵심 위험 영역**입니다. 또한 커버리지 수치가 높다는 것은 이 영역이 실제 현업에서 **자주 테스트되고, 현실적인 위협으로 폭넓게 인식**되고 있음을 보여 줍니다.

## 3. 위험 설명 (Description)

Security Misconfiguration은 **시스템·애플리케이션·클라우드 서비스가 보안 관점에서 부적절하게 설정된 상태**를 의미하며, 이로 인해 다양한 취약점이 발생할 수 있다.

1. **스택 전반의 하드닝 부족·클라우드 권한 설정 오류**
    - 애플리케이션 서버, 웹 서버, DB, 메시지 브로커, 클라우드 스토리지·IAM 권한 등 **어느 한 계층이라도 보안 강화(hardening)가 제대로 되어 있지 않거나 과도한 권한이 부여**된 경우.
2. **불필요한 기능·서비스·포트 활성화**
    - 사용하지 않는 포트, 서비스, 샘플 페이지, 테스트 프레임워크, 기본 계정, 과도한 권한 등을 그대로 둔 채 운영 환경에 배포하는 경우.
3. **기본 계정·기본 비밀번호 유지**
    - 제품 설치 시 제공되는 **기본 관리자 계정과 초기 비밀번호를 변경하지 않고 그대로 사용**하는 경우.
4. **에러 처리·로그 설정 미비로 인한 과도한 정보 노출**
    - 중앙집중적인 에러 처리·설정이 없어, 예외 발생 시 **스택 트레이스나 내부 경로, 버전 정보** 등이 그대로 사용자에게 노출되는 경우.
5. **업그레이드 후 보안 기능 비활성화 또는 미설정**
    - 시스템 업그레이드나 신규 기능 도입 후, 제공되는 **최신 보안 기능(예: 강화된 인증·암호화 옵션)을 활성화하지 않거나 안전하지 않은 기본값 그대로 사용하는 경우.**
6. **하위 호환성(Backward Compatibility)에 과도하게 의존**
    - 옛날 클라이언트·프로토콜과의 호환성을 이유로 **취약한 옵션을 계속 활성화**해 두는 경우.
7. **플랫폼·프레임워크·DB의 보안 옵션 미설정**
    - Struts, Spring, ASP.NET, Django 등 프레임워크, 라이브러리, DBMS의 **보안 관련 설정을 기본값 그대로 방치**하고, 안전한 값으로 재설정하지 않는 경우.
8. **보안 헤더 미사용 또는 잘못된 값 사용**
    - 서버가 `Content-Security-Policy`, `X-Frame-Options`, `Strict-Transport-Security` 등의 **보안 헤더를 전송하지 않거나, 안전하지 않은 값으로 설정**하는 경우.
9. **환경별 설정 불일치**
    - 개발·QA·운영 환경의 보안 설정이 크게 다르고, **운영만 예외적으로 느슨하거나, 반대로 운영이 너무 복잡해 관리가 안 되는 경우**.
10. **검증되지 않은 클라우드·인프라 템플릿 사용**
    - IaC(Terraform, CloudFormation 등) 템플릿이나 쿠버네티스 매니페스트를 **보안 검토 없이 재사용**하여, 잘못된 네트워크 정책·보안 그룹·스토리지 권한 등이 그대로 전파되는 경우.

이처럼 **일관된 보안 설정·하드닝 프로세스가 없으면**, 시스템은 구성 요소가 늘어날수록 누적된 설정 오류로 인해 공격 표면이 크게 확장된다.

## 4. 예방 방법 (How to prevent)

Security Misconfiguration을 줄이기 위해서는 **반복 가능하고 표준화된 보안 하드닝·설정 관리 프로세스**가 필수적이다. OWASP에서 제안하는 핵심 예방책은 다음과 같다:

1. **반복 가능한 하드닝 프로세스 구축**
    - 개발·QA·운영 환경을 **동일한 기준으로 잠근(hardened) 상태**로 빠르게 구축할 수 있는 절차를 만들고, 환경별로는 **다른 자격 증명(계정·키·비밀 값)** 만 사용하도록 한다.
    - 이 과정을 자동화(IaC, 스크립트, Ansible 등)하여 새로운 환경을 만들 때마다 보안 수준이 떨어지지 않도록 한다.
2. **최소 구성 원칙(Minimal Platform)**
    - 사용하지 않는 기능, 컴포넌트, 샘플 코드, 디버그 페이지, 문서 등을 **설치 단계부터 제거**하거나 설치하지 않는다.
    - 운영 환경에는 **진짜 필요한 것만 올라가도록** 플랫폼을 최소화한다.
3. **패치·보안 공지 기반 설정 검토**
    - 패치 관리 프로세스의 일부로, 보안 공지·릴리스 노트에 따라 **필요한 설정 변경 작업을 정기적으로 수행**한다.
    - 특히 **클라우드 스토리지 권한(S3 등 버킷 권한)** 을 정기적으로 검토해, 퍼블릭 노출이나 과도 권한이 없는지 확인한다.
4. **분리·세분화된 아키텍처 설계**
    - 컴포넌트·테넌트 간에 **네트워크·권한·리소스 수준의 분리(segmentation)** 를 적용한다.
    - 컨테이너, VPC, 보안 그룹(ACL) 등을 활용해, 한 계층의 오구성이 전체 시스템으로 확산되지 않도록 한다.
5. **보안 헤더·지시문(Security Directives) 적용**
    - 서버에서 `HSTS`, `CSP`, `X-Frame-Options`, `Referrer-Policy` 등 **보안 헤더를 일관되게 전송**하고,
    - 기본값이 아닌 **강한 정책 값**을 사용해 브라우저 측 보호막을 강화한다.
6. **환경 전반 설정 검증의 자동화**
    - 모든 환경에 대해 설정·권한·보안 헤더·포트·서비스 등을 자동으로 점검하는 **설정 검증 스크립트/도구**를 도입한다.
    - IaC 템플릿·쿠버네티스 매니페스트에 대해 정적 분석·정책 검증을 수행하도록 한다.
7. **에러 메시지 중앙 관리·차단 레이어 추가**
    - 과도한 에러 메시지가 사용자에게 직접 노출되지 않도록, **중앙 집중형 에러 처리·로깅·마스킹 계층**을 두고 스택 트레이스·환경 변수·내부 경로 등 민감 정보는 항상 필터링한다.
8. **정기적인 수동 검증(자동화 미비 시)**
    - 위 작업이 자동화되지 않은 경우, 최소 연 1회 이상 **수동 점검으로 설정·하드닝 상태를 검증**해야 한다.
 
## 5. 예시 공격 시나리오 (Example attack scenarios)
### 시나리오 1 – 샘플 애플리케이션·기본 계정 방치로 인한 서버 장악

한 애플리케이션 서버는 설치 시 함께 제공되는 **샘플 애플리케이션과 관리자 콘솔**을 운영 환경에서도 그대로 두고 있었다.  
이 샘플 애플리케이션들은 이미 알려진 취약점이 많았고, 관리 콘솔 역시 **기본 관리자 계정·기본 비밀번호**가 그대로 활성화된 상태였다.  
공격자는 검색 엔진과 자동화된 스캐닝 도구를 사용해 샘플 앱과 콘솔 URL을 찾아낸 뒤, 공개된 기본 자격 증명으로 관리자 콘솔에 로그인하여 서버 전체를 장악한다.

### 시나리오 2 – 디렉터리 리스팅으로 코드 구조 노출 및 추가 취약점 악용

웹 서버에서 **디렉터리 리스트 기능을 비활성화하지 않은** 상태로 운영 중이었다.  
공격자는 특정 URL에 슬래시를 붙여 접근해 보다가 디렉터리 목록이 그대로 노출되는 것을 발견한다.  
이후 컴파일된 Java 클래스 파일들을 내려받아 디컴파일한 뒤,  
코드에서 **심각한 접근 제어 결함과 추가 취약점**을 찾아내 애플리케이션을 더 깊게 침해한다.

### 시나리오 3 – 상세 오류 메시지를 통한 내부 정보·취약점 노출

애플리케이션 서버 설정상 **자세한 오류 메시지(스택 트레이스, 내부 경로, 라이브러리 버전 등)** 가 사용자에게 그대로 반환되도록 구성되어 있었다.  
공격자는 의도적으로 잘못된 입력을 보내 다양한 예외를 유도하면서, 응답에 포함된 정보로 사용 중인 프레임워크 버전·라이브러리 이름·경로 구조 등을 파악한다.  
이를 바탕으로, 알려진 취약 버전에 해당하는 공격 코드를 적용해 시스템을 침해하거나, 공격 범위를 확장한다.

### 시나리오 4 – 퍼블릭으로 열려 있는 클라우드 스토리지

한 조직은 클라우드 서비스 제공자(CSP)의 스토리지 버킷을 사용하고 있었는데, 해당 CSP의 **기본 설정이 “인터넷 전체에 공유 허용”** 상태였음에도 이를 인지하지 못했다.  
버킷 권한은 별도 검토 없이 그대로 운영에 사용되었고, 그 안에는 고객 개인정보·보고서·내부 로그 등 **민감 데이터가 평문 형태로 저장**되어 있었다.  
공격자는 공개된 버킷을 검색·열람하는 도구를 사용해 해당 버킷을 찾아내고, 내부 데이터를 그대로 다운로드한다.

---

## 참고

- [OWASP Foundation – A02:2025 Security Misconfiguration](https://owasp.org/Top10/2025/A02_2025-Security_Misconfiguration/ "A02 Security Misconfiguration - OWASP Top 10:2025")