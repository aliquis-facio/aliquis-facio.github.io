# Authentication Failures
## 1. 배경 (Background)

- **순위 변화**
    
    - 2021 Top 10에서 A07이었고, 2025 RC1에서도 그대로 **#7 유지**. 
        
- **이름 변경**
    
    - 기존 이름: _Identification and Authentication Failures_
        
    - 2025 이름: _Authentication Failures_  
        → 이 카테고리에 매핑된 **36개 CWE의 내용**을 더 정확히 반영하기 위해 이름을 다듬은 것. 
        
- **대표 CWE**
    
    - CWE-259: 하드코딩된 비밀번호 사용
        
    - CWE-297: 호스트 불일치 인증서 검증 실패
        
    - CWE-287: 부적절한 인증
        
    - CWE-384: 세션 고정(Session Fixation)
        
    - CWE-798: 하드코딩된 자격 증명 사용 
        
- **의미**
    
    - SSO, OAuth, OpenID Connect 같은 **표준 인증 프레임워크 사용이 늘면서** 어느 정도 개선은 됐지만,  
        여전히 **“잘못된 인증/세션 설계·구현”은 큰 위험**으로 남아 있음. 
        



## 2. 점수표 (Score table)

OWASP 데이터 기준 지표는 다음과 같아요: 

|항목|값|
|||
|매핑된 CWE 개수|36|
|최대 발생률(Max Incidence)|15.80%|
|평균 발생률(Avg Incidence)|2.92%|
|최대 커버리지(Max Coverage)|100.00%|
|평균 커버리지(Avg Coverage)|37.14%|
|가중 Exploit 점수 평균|7.69|
|가중 Impact 점수 평균|4.44|
|총 발생 건수|1,120,673|
|관련 CVE 개수|7,147|

**해석 포인트**

- 분석된 앱 중 **약 2.9%**가 인증 실패 관련 취약점을 최소 1개 보유.
    
- 관련 **CVE가 7천 개 이상** → 여전히 “실전에서 자주 터지는 문제”라는 뜻.
    



## 3. 설명 (Description)

### 3-1. 어떤 취약점인가?

> **유효하지 않은 사용자/세션이 “정상 사용자”로 인식되게 속일 수 있을 때** 발생하는 모든 인증·세션 관리 관련 취약점. 

애플리케이션이 아래와 같은 특징을 가지면 Authentication Failures에 해당할 수 있습니다: 

1. **자동화 공격 허용**
    
    - 유출된 ID/비밀번호 리스트로 **credential stuffing** 가능.
        
    - 최근에는 유출된 비밀번호를 **조금씩 변형·증분**해서 시도하는  
        **하이브리드 credential stuffing / password spray 공격**까지 포함.  
        (예: `Winter2025` → `Winter2026`, `Password1!` → `Password2!` 등)
        
2. **브루트포스/스크립트 공격을 빠르게 차단하지 못함**
    
    - 로그인 실패 제한/딜레이, CAPTCHA, 봇 차단, IP/행위 기반 방어가 부족.
        
3. **기본/약한/잘 알려진 비밀번호 허용**
    
    - `Password1`, `admin/admin`, `admin/1234` 같은 조합을 그대로 허용. 
        
4. **이미 유출된 자격 증명으로 신규 계정 생성 허용**
    
    - 새 계정/비밀번호 설정 시 **breach 목록 체크를 하지 않음**.
        
5. **취약한 비밀번호 복구/리커버리**
    
    - “좋아하는 색은?”, “애완동물 이름?” 같은 **지식 기반 Q&A**에 의존.
        
    - 이런 방식은 OSINT로 쉽게 추측 가능해서 **본질적으로 안전하게 만들 수 없음**.
        
6. **비밀번호 저장/보호 문제**
    
    - 평문 저장
        
    - 단순 암호화(키 관리 부실)
        
    - 느린 해시 + salt 같은 현대적 방식이 아닌 **약한 해시** 사용  
        (자세한 내용은 A02 Cryptographic Failures와도 연결). 
        
7. **MFA 미구현 또는 무력화**
    
    - **MFA 자체가 없거나**,
        
    - “문자 인증 안 되면 이메일 링크만 누르면 통과” 같은 **허술한 우회 플로우** 존재.
        
8. **세션 ID/토큰 노출**
    
    - 세션 ID를
        
        - URL 쿼리스트링,
            
        - 숨겨진 필드,
            
        - 기타 클라이언트가 쉽게 접근 가능한 위치에 노출.
            
9. **세션 관리 부실**
    
    - 로그인 후에도 **세션 ID 재발급 없이 재사용**.
        
    - 로그아웃/일정 시간 미사용/절대 타임아웃 시  
        세션/SSO 토큰을 제대로 **무효화하지 않음**. 
        



## 4. 예방 방법 (How to prevent)

OWASP가 제안하는 방어 전략을 핵심만 뽑으면: 

1. **MFA(다단계 인증) 적극 사용**
    
    - 가능하면 모든 중요 시스템에 MFA 강제.
        
    - credential stuffing / brute force / 유출 계정 재사용을 크게 줄여줌.
        
2. **비밀번호 관리자 사용 장려**
    
    - 사용자에게 **패스워드 매니저 사용**을 권장/지원해서  
        긴 랜덤 비밀번호를 쓰도록 유도.
        
3. **기본/하드코딩 자격 증명 금지**
    
    - 제품/서비스를 **default 계정·비밀번호 상태로 출고/배포 금지**.
        
    - 특히 관리자 계정은 무조건 초기 변경을 강제.
        
4. **약한 비밀번호 차단**
    
    - 새 비밀번호/변경 시
        
        - **Top 10,000 worst passwords** 등 블랙리스트 체크.
            
        - `qwerty123`, `P@ssw0rd` 같은 패턴은 즉시 차단.
            
    - 동시에, **유출된 비밀번호 목록(haveibeenpwned 등)**과 대조해서  
        이미 털린 비밀번호는 사용 금지.
        
5. **현대적인 비밀번호 정책**
    
    - 길이/복잡도/변경 정책은 **NIST SP 800-63b 5.1.1** 등  
        최신 증거 기반 가이드를 따를 것. 
        
    - **주기적 강제 변경(3개월마다 바꾸세요)** 같은 구식 정책은  
        재사용·패턴화된 약한 비밀번호를 부추기므로,  
        **침해 의심 시에만 비밀번호 변경을 강제**.
        
6. **계정 열거 방지**
    
    - 회원가입, 로그인, 비번 찾기, 관련 API에서
        
        - “존재하지 않는 아이디입니다” / “비밀번호가 틀렸습니다”를 구분하지 말고  
            **항상 동일한 에러 메시지** 사용  
            (예: `Invalid username or password.`).
            
7. **로그인 시도 제한 & 모니터링**
    
    - 실패 횟수 제한, 딜레이 증가, CAPTCHA, IP/디바이스 기반 탐지 등으로  
        **브루트포스/봇 공격을 느리게/비싸게** 만들기.
        
    - 실패 로그는 **중요 보안 이벤트로 기록 + 알림** 설정.
        
8. **서버 사이드 세션 관리자 사용**
    
    - 언어/프레임워크에서 제공하는 **검증된 세션 관리 기능** 사용.
        
    - 요구 사항:
        
        - 로그인 후 **고엔트로피 랜덤 세션 ID 새로 발급**
            
        - 세션 ID는 URL에 절대 노출 X
            
        - **Secure, HttpOnly, SameSite** 쿠키 사용
            
        - 로그아웃, 일정 시간 미사용, 절대 타임아웃 시 세션 무효화.
            
9. **검증된 인증/IDaaS 솔루션 활용**
    
    - 가능하면 직접 인증 시스템을 만들기보다는  
        **검증된 IdP/IDaaS/프레임워크(예: Keycloak, Auth0, Cognito 등)**로 리스크 전가.
        



## 5. 예시 공격 시나리오 (Example attack scenarios)

### 시나리오 1 – 하이브리드 Credential Stuffing / Password Spray

- 공격자는 기존 유출 데이터에서 `ID + 비밀번호` 목록을 확보.
    
- 단순 그대로 입력하는 것에 그치지 않고,
    
    - `Winter2025` → `Winter2026`
        
    - `ILoveMyDog6` → `ILoveMyDog7`, `ILoveMyDog5`  
        처럼 **사람이 자주 쓰는 변형 패턴**까지 자동으로 시도. 
        
- 애플리케이션이
    
    - MFA도 없고,
        
    - 로그인 실패 제한/딜레이, 이상 징후 탐지도 없다면,  
        → 이 앱은 사실상 **“비밀번호 오라클”** 역할을 하게 되고,  
        유효 계정을 대량으로 털릴 수 있음.
        



### 시나리오 2 – 비밀번호만 쓰는 레거시 인증

- 어떤 기관이 모든 핵심 시스템에 아직도 **ID + 비밀번호 한 가지 요소만** 사용.
    
- 게다가
    
    - 복잡도 요구사항이 과도(특수문자, 대소문자, 숫자 포함)하면서
        
    - 주기적 변경(예: 90일마다 변경)을 강제.
        
- 사용자는 결국
    
    - 여러 시스템에서 **비밀번호 재사용**,
        
    - `Spring2025!`, `Spring2026!` 식의 **패턴화된 약한 비밀번호**로 귀결.
        
- 공격자는:
    
    - 한 시스템에서 유출된 비밀번호를
        
    - 다른 시스템에 credential stuffing + 변형을 섞어 시도해  
        광범위하게 계정을 탈취. 
        



### 시나리오 3 – 세션 타임아웃/로그아웃 설계 실패

- 앱이 **세션 타임아웃을 충분히 짧게 잡지 않고**,  
    탭을 그냥 닫아도 세션이 살아 있는 상태.
    
- 공유 PC(PC방, 학교, 회사 공용 PC 등)에서
    
    - 사용자가 로그인 후 탭만 닫고 자리를 떠남.
        
- 또는 SSO 환경에서
    
    - 한 번 로그인하면 여러 서비스에 자동 로그인되지만,
        
    - **Single Logout(SLO)**는 구현이 제대로 안 되어  
        현재 서비스만 로그아웃되고 나머지는 유지. 
        
- 뒤에 온 사람이 같은 브라우저를 열었을 때,
    
    - 사용자가 **로그아웃했다고 착각한 상태에서 여전히 로그인된 세션**을 이용해  
        메일, 문서, 채팅 등 민감 정보에 접근 가능.
        



필요하면 이걸 그대로 과제용으로 쓰기 쉽게  
**“배경/점수표/설명/예방/시나리오” 섹션을 한글 문서/마크다운 템플릿** 형태로 다시 뽑아줄게요.