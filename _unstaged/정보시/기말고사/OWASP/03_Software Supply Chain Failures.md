# Software Supply Chain Failures
## 1. Background

- 이 항목은 OWASP Top 10:2025 커뮤니티 설문에서 **50%가 1순위**로 뽑은, 사실상 **가장 우선순위가 높은 위험**임.
- 원래는 2013년 Top 10의 `A9 – Using Components with Known Vulnerabilities`에서 출발했는데,  
    이제는 **“취약한 컴포넌트” → 전체 소프트웨어 공급망 실패**로 범위가 확장됨.
- 관련 CVE는 **11개뿐이라 숫자는 적지만**, 실제 데이터에선 **평균 발생률이 5.19%로 Top 10 중 1위**라서 위험성이 크다고 평가됨.
- 대표적으로 매핑된 CWE:
    - CWE-447: Use of Obsolete Function
    - CWE-1104: Use of Unmaintained Third Party Components
    - CWE-1329: Reliance on Component That is Not Updateable
    - CWE-1395: Dependency on Vulnerable Third-Party Componen

## 2. Score table

OWASP가 수집한 데이터 기준 점수표:
- **CWEs Mapped**: 5개
- **Max Incidence Rate(최대 발생률)**: 8.81%
- **Avg Incidence Rate(평균 발생률)**: 5.19% ← 카테고리 중 **가장 높음**
- **Max Coverage(최대 커버리지)**: 65.42%
- **Avg Coverage(평균 커버리지)**: 28.93%
- **Avg Weighted Exploit**: 8.17
- **Avg Weighted Impact**: 5.23
- **Total Occurrences(총 발생 건)**: 215,248
- **Total CVEs**: 11

→ 정리하면, **CVE 개수는 적지만 실제 테스트 데이터에서 매우 자주 발견되고, 공격 가능성도 높다**는 의미.

## 3. Description
### 3-1. 정의

- **소프트웨어 공급망 실패**란  
    **소프트웨어를 빌드·배포·업데이트하는 전체 과정**에서 사용하는  
    **타사 코드, 툴, 라이브러리, 레지스트리 등**이 취약하거나 악성으로 변조되어  
    그 결과 시스템이 침해되는 것을 말함.

### 3-2. “너 취약할 확률 높다” 체크리스트 (You are likely vulnerable if…)

아래에 해당하면 취약할 가능성이 높다고 판단:
1. **버전·의존성 추적 안 함**
    - 서버/클라이언트 컴포넌트 버전(프레임워크, 라이브러리 등)을 체계적으로 관리하지 않음.
    - 직접 의존성뿐 아니라 **transitive dependency**까지 파악 안 함.
2. **구형·미패치·미지원 소프트웨어 사용**
    - OS, WAS, DBMS, 라이브러리, 런타임 등이 오래되었거나 **지원 종료(EOL)** 상태.
3. **취약점 스캔·보안 공지 구독 안 함**
    - 주기적인 취약점 스캐닝을 안 하고, CVE나 벤더 보안 공지에도 구독 안 함.
4. **공급망 변경 관리 부재**
    - IDE/플러그인, 코드 저장소, 샌드박스, 이미지/라이브러리 레포, 아티팩트 생성 방식 등  
        공급망 구성요소의 변경을 문서화·추적하지 않음.
5. **공급망 하드닝 부족 & 최소 권한 실패
    - 코드 저장소, CI/CD, 레지스트리 등의 접근제어와 최소 권한이 제대로 적용되지 않음.
6. **Separation of Duty 없음**
    - **한 사람이 코드 작성 → 빌드 → 프로덕션 배포까지** 단독으로 수행 가능.
7. **비신뢰 소스에서 컴포넌트 다운로드**
    - 검증되지 않은 Git repo, 비공식 패키지 레지스트리 등에서 가져온 컴포넌트를  
        검증 없이 프로덕션에 사용.
8. **패치/업그레이드가 느리고 비계획적**
    - 월간/분기 정기 패치만 수행해서, 공개된 취약점이 **수주~수개월 동안 방치**됨.
9. **업데이트 후 테스트 부족**
    - 라이브러리/프레임워크 업데이트 후 **호환성·회귀 테스트**가 충분치 않음.
10. **시스템 구성(Security Misconfiguration) 미흡**
	- 환경 설정이 제대로 보안 설정되어 있지 않음(A02 항목과도 연결). 
11. **복잡한 CI/CD인데 보안이 더 약함**
	- 파이프라인은 복잡하지만, 계정·비밀관리·로그·무결성 보호가 허술.
	
## 4. How to Prevent

핵심은 **패치 관리 프로세스 + SBOM + 공급망 하드닝** 세 가지 축.

### 4-1. 패치 관리 & SBOM 중심 프로세스

1. **SBOM 관리**
    - 전체 소프트웨어에 대한 **SBOM(Software Bill of Materials)** 작성 및 중앙 관리.
    - 직접 의존성 + transitive dependency까지 포함해 **항상 최신 상태로 유지**.
2. **불필요 요소 제거 (Attack Surface Reduction)**
    - 사용하지 않는 **의존성, 기능, 컴포넌트, 파일, 문서**를 제거하여 공격 표면 축소.
3. **버전 인벤토리 & SCA 도입**
    - 클라이언트/서버 컴포넌트(프레임워크, 라이브러리)의 버전을 지속적으로 인벤토리화.
    - OWASP Dependency Check, retire.js 등의 도구 활용.
4. **취약점 모니터링 자동화**
    - CVE, NVD 등의 소스를 **지속 모니터링**하고  
        SCA / SBOM 툴로 **자동 알림·리포트**를 받음.
5. **공식·신뢰된 소스 사용 + 서명 검증
    - **공식 저장소**에서만 패키지 다운로드.
    - 가능한 경우 **서명된 패키지**만 사용해 변조 여부 확인.
6. **버전 전략 수립**
    - 무작정 최신 버전이 아니라, **위험도 기반으로 업그레이드 필요성을 판단**하고 계획적으로 업데이트.
7. **미유지·무패치 라이브러리 관리**
    - 더 이상 유지보수가 안 되는 라이브러리는 교체를 고려.
    - 교체가 당장은 불가능하면 **가상 패치(virtual patch)** 적용도 고려.
8. **개발 도구 및 CI/CD도 정기 업데이트**
    - IDE, 플러그인, CI/CD 툴, SBOM 툴 자체도 정기적으로 업데이트.

### 4-2. 공급망 하드닝 & 변경 관리

1. **변경 관리 프로세스**
    - 다음 항목들에 대한 변경을 **체계적으로 문서화·추적**:
        - CI/CD 설정, 빌드 도구, 파이프라인
        - 코드 저장소, 샌드박스
        - IDE, SBOM 툴 및 생성된 아티팩트
        - 로그 시스템, 3rd party SaaS 연동
        - 아티팩트/컨테이너 레지스트리 등
2. **핵심 시스템 하드닝 (MFA·IAM 강화)**
    - 코드 저장소
        - 비밀 값 체크인 금지, 브랜치 보호, 백업, MFA 적용.
    - 개발자 워크스테이션
        - 정기 패치, MFA, 모니터링, EDR/백신.
    - 빌드 서버 & CI/CD
        - 역할 분리, 최소 권한, 서명된 빌드, 환경별 비밀 관리, 변조 탐지 가능한 로그.
    - 아티팩트/이미지
        - 출처(provenance), 서명, 타임스탬프 관리.
        - 각 환경마다 다시 빌드하는 대신 **검증된 아티팩트를 promote**.
    - IaC(Infra as Code)
        - 일반 코드와 동일하게 PR/리뷰/버전 관리.
3. **지속적인 보안 운영**
    - 애플리케이션 수명 전체에 걸쳐 **업데이트·설정 변경·패치 적용**을 위한  
        모니터링·우선순위 지정·적용 프로세스를 계속 유지.

## 5. Example Attack Scenarios

1. **Scenario #1 – SolarWinds 공급망 공격 (2019)**
    - 신뢰하던 벤더(네트워크 모니터링/관리 솔루션)의 업데이트가 공격자에 의해 악성 코드 포함.
    - 이 업데이트를 설치한 약 **18,000개 조직**의 시스템이 동시에 침해.
2. **Scenario #2 – Bybit 지갑 소프트웨어 공급망 공격 (2025)**
    - 암호화폐 지갑 소프트웨어에 **조건부로 동작하는 악성 코드** 삽입.
    - **지갑이 실제 사용될 때만** 악성 동작을 수행하여 탐지를 회피.
    - 결과적으로 약 **15억 달러 규모**의 자산 탈취.
3. **Scenario #3 – GlassWorm: VS Code / OpenVSX 확장 공격 (2025)**
    - VS Code 마켓플레이스와 OpenVSX의 합법적인 확장에 **눈에 안 보이는 자기 전파 코드** 주입.
    - 확장이 자동 업데이트되면서 개발자 PC에 광범위하게 퍼짐.
    - 감염되면 로컬 비밀(토큰, 키, 지갑 등)을 탈취하고, C2 연결 및 암호화폐 지갑 탈취를 시도.
    - 포인트: **“개발자 워크스테이션 자체가 이제 주요 공격 타깃”** 이라는 걸 보여준 사례.
4. **Scenario #4 – 취약 컴포넌트(RCE, IoT 등) 악용**
    - 앱과 같은 권한으로 돌아가는 컴포넌트에 RCE 취약점이 있으면,  
        그 컴포넌트를 통해 서버 전체를 장악할 수 있음.
    - 예:
        - Struts 2 RCE(CVE-2017-5638) → 실제로 큰 규모의 침해 사고 발생.
        - 패치하기 어려운 IoT·의료기기 등은 취약점이 남아 있으면 영향이 막대.
    - Shodan 같은 검색 엔진으로 **미패치/미설정 시스템을 자동 탐색**할 수 있어 공격 난이도가 낮음.