# Software Supply Chain Failures
## 1. 배경 (Background)

- **순위·위상**: OWASP Top 10:2025에서 **A03**은 새로 추가된 항목이지만, 커뮤니티 설문에서 정확히 **50%가 1순위(#1)** 로 선택할 정도로 우선순위가 높은 리스크로 평가됨.
- **이전 항목의 확장**: 단순히 “취약하거나 오래된 컴포넌트” 문제를 넘어, **소프트웨어를 빌드·배포·업데이트하는 전체 공급망 과정에서의 실패** 전반을 포괄하는 범주로 확장되었다.
    - 2013: _A9 – Using Components with Known Vulnerabilities_
    - 2021: _A06 – Vulnerable and Outdated Components_
    - 2025: _A03 – Software Supply Chain Failures_
- **데이터 특성**:
    - 관련 **CVEs는 단 11개**에 불과하지만, 기여된 테스트 데이터에서는 **Top 10 중 가장 높은 평균 발생률(5.19%)** 을 기록.
    - 즉, 전통적인 취약점(CVE) 통계로는 잘 보이지 않지만, 실제 테스트 상에서는 **굉장히 자주 발견되는 시스템적 리스크**라는 뜻이다.
- **정의**: **소프트웨어를 빌드·배포·업데이트하는 과정 전체에서 발생하는 붕괴(breakdown)나 침해(compromise)** 를 의미하며, 보통 다음에서 기인한다:
    - 서드파티 코드·툴·라이브러리·런타임·빌드/배포 도구에 존재하는 취약점
    - 혹은 이들에 대한 악의적인 변조(멀웨어 삽입, 계정 탈취 후 악성 업데이트 배포 등)
- **대표 CWE** (A03 범주에 매핑된 약점들):
    - **CWE-477** – Use of Obsolete Function (사용 중단된/구식 기능 사용)
    - **CWE-1035** – 2017 Top 10 A9: Using Components with Known Vulnerabilities (알려진 취약 컴포넌트 사용)
    - **CWE-1104** – Use of Unmaintained Third Party Components (유지보수 중단된 서드파티 컴포넌트 사용)
    - **CWE-1329** – Reliance on Component That is Not Updateable (업데이트 불가능한 컴포넌트에 대한 의존)
    - **CWE-1395** – Dependency on Vulnerable Third-Party Component (취약한 서드파티 컴포넌트에 대한 의존)

## 2. Score table (점수 표)

| 항목                     | 값       |
| ---------------------- | ------- |
| 매핑된 CWE 수              | 5       |
| 최대 발생률 (Max Incidence) | 8.81%   |
| 평균 발생률 (Avg Incidence) | 5.19%   |
| 최대 커버리지 (Max Coverage) | 65.42%  |
| 평균 커버리지 (Avg Coverage) | 28.93%  |
| 가중 평균 Exploit 점수       | 8.17    |
| 가중 평균 Impact 점수        | 5.23    |
| 총 발생 건수                | 215,248 |
| 총 CVE 수                | 11      |

정량 지표를 종합하면, **Software Supply Chain Failures는 CVE 숫자는 적지만(11개), 실제 테스트 상 발생률이 높고(평균 5.19%), 악용 난이도(Exploit)와 영향(Impact) 모두 Top 10 중 최상위권인 “저빈도·고위험의 구조적 리스크”** 로 볼 수 있습니다. 특히, 전통적인 취약점 스캐닝만으로는 잘 포착되지 않는 영역이라는 점이 중요합니다.

## 3. 위험 설명 (Description)

Software supply chain failures는 **소프트웨어를 빌드·배포·업데이트하는 과정** 전반에서 발생하는 침해 또는 붕괴를 의미한다. 주로 다음과 같은 상황에서 나타난다:

1. **구성 요소 버전·의존성 추적 부족**
    - 클라이언트·서버 측을 포함해 애플리케이션이 사용하는 **모든 컴포넌트(직접 + 트랜지티브 의존성)** 의 버전을 체계적으로 추적하지 않는다.
2. **취약·지원 종료·구버전 컴포넌트 사용**
    - 운영체제, 웹/앱 서버, DBMS, 애플리케이션, 라이브러리, 런타임 등 구성 요소가 이미 알려진 취약점을 가지고 있거나, 더 이상 지원·패치가 제공되지 않는 상태인데도 계속 사용된다.
3. **정기적인 취약점 스캔 및 보안 공지 구독 미흡**
    - 사용하는 컴포넌트에 대해 **정기적으로 취약점 스캔을 수행하지 않거나**, 관련 CVE/NVD·벤더 보안 공지를 구독하지 않는다.
4. **공급망(Change Management) 변경 추적 부재**
    - 다음과 같은 공급망 요소의 변경 사항을 추적·관리하지 않는다:
        - IDE 및 IDE 확장/업데이트
        - 코드 저장소(Repo)의 설정·브랜치·Hook
        - 샌드박스, 테스트/빌드 이미지 및 라이브러리 저장소
        - 아티팩트 생성·저장 방식 등
    - 즉, **공급망 전체에 대한 변경 관리(Change Management) 프로세스가 부재**하다.
5. **공급망 요소 하드닝 및 최소 권한 미적용**
    - 코드 저장소, 빌드 서버, CI/CD 도구, 패키지/컨테이너 레지스트리 등 **공급망 구성 요소에 대한 하드닝(보안 강화)과 최소 권한(Least Privilege) 적용이 부족**하다.
6. **분리되지 않은 역할·권한 (Separation of Duties 미흡)**
    - 한 사람이 **코드를 작성하고, 자체적으로 빌드·승인·배포까지 모두 수행할 수 있는 구조**이다.
    - 즉, 공급망 시스템 전반에 걸쳐 분리된 역할(SoD)이 보장되지 않는다.
7. **비신뢰 소스에서의 컴포넌트 사용 허용**
    - 개발자·DevOps·인프라 담당자가 **공식적인 검증 없이 임의 출처(비공식 레지스트리, 임의 Git repo, 무명 패키지 등)** 에서 가져온 패키지·이미지를 그대로 프로덕션에 사용한다.
8. **위험 기반·시기 적절한 패치/업데이트 미흡**
    - 패치가 **월간/분기별 변경 윈도우에만 반영**되어, 그 사이 수 주~수개월 동안 알려진 취약점에 노출되기도 한다.
    - 위험도가 높은 취약점에 대해 **긴급 패치를 적용할 수 있는 체계**가 없다.
9. **업데이트 라이브러리의 호환성 테스트 부족**
    - 라이브러리나 프레임워크를 업데이트/업그레이드/패치하면서 애플리케이션과의 호환성·기능 테스트를 제대로 수행하지 않아, 취약점 수정 과정에서 새로운 장애/보안 문제를 만들어 낸다.
10. **구성(설정) 보안 미흡**
    - 공급망을 구성하는 모든 시스템(코드 저장소, 빌드 서버, 레지스트리 등)의 **보안 설정이 적절히 보호되지 않음**.
    - 이는 A02 Security Misconfiguration 영역과도 직접적으로 연결된다.
11. **복잡하지만 덜 안전한 CI/CD 파이프라인**
    - 구성 요소는 많고 복잡하지만, **파이프라인 그 자체의 보안 수준이 애플리케이션 본체보다 낮은 경우**.
    - 예: CI 서버만 MFA 미적용, 권한 과다, 감사 로그 미비 등.

요약하면, **“내 코드”만 안전하면 된다는 사고방식이 위험**하며,  
빌드·배포·업데이트에 관여하는 **모든 도구·사람·프로세스가 하나의 공격 표면** 이 된다는 점이 핵심입니다.

## 4. 예방 방법 (How to prevent)

OWASP는 **패치 관리 + SBOM + 공급망 전반 하드닝/모니터링**을 중심으로 다음과 같은 예방책을 제시한다.

1. **SBOM(Software Bill of Materials) 확보·중앙 관리**
    - 애플리케이션 전체에 대해 **SBOM을 작성·유지**하고, 이를 중앙에서 관리되는 “SBOM 사전(dictionary)” 형태로 운영한다.
2. **직접·트랜지티브 의존성 모두 추적**
    - 내가 명시한 의존성뿐 아니라, 그 의존성이 끌어오는 **트랜지티브 의존성까지 계층적으로 추적**한다.
3. **미사용 의존성·기능 제거(공격 표면 축소)**
    - 사용하지 않는 라이브러리, 기능, 컴포넌트, 파일, 샘플 문서 등을 제거해 **공격 표면을 최소화**한다.
4. **버전·의존성의 지속적인 인벤토리 관리**
    - client/server 양쪽의 프레임워크·라이브러리 버전을 **자동 도구(OWASP Dependency-Check, retire.js 등)로 지속 인벤토리**하며, 변화를 추적한다.
5. **CVE/NVD·보안 공지 상시 모니터링 및 SCA 도구 활용**
    - CVE, NVD, 벤더 보안 공지를 **지속 모니터링**하고, SCA(Software Composition Analysis), SBOM 기반 도구를 활용해 **알림·대응을 자동화**한다.
    - 사용하는 컴포넌트에 대한 이메일 알림·피드 구독.
6. **공식·신뢰 소스 + 서명된 패키지 사용**
    - 컴포넌트는 **공식 레지스트리·신뢰된 소스에서만**, 가능한 경우 **서명된 패키지(코드 서명, Sigstore 등)** 만 사용하여 악성 변조 가능성을 줄인다.
7. **버전 선택과 업그레이드의 의도적 관리
    - 무작정 최신 버전을 따라가는 것이 아니라, **위험·기능·호환성을 고려한 버전 선택 전략**을 세우고, 필요할 때에만 계획적으로 업그레이드한다.
8. **유지보수 중단·패치 없는 컴포넌트에 대한 전략**
    - 더 이상 유지보수·패치가 이뤄지지 않는 라이브러리에 대해서는 대체 라이브러리로 교체하거나, 불가피한 경우 가상 패치(WAF, RASP, 모니터링 룰 등) 로 보완한다.
9. **CI/CD·IDE·개발 도구의 정기 업데이트 및 하드닝**
    - CI/CD 파이프라인, 빌드 서버, IDE, 플러그인 등 **개발 도구 자체도 공급망의 일부**로 보고 정기 패치, MFA 적용, 최소 권한, tamper-evident 로그, 서명된 빌드 등으로 하드닝한다.
10. **변경 관리(Change Management) 프로세스 구축**
    - 다음 항목들에 대한 변경을 **추적·검토·기록**하는 체계를 갖춘다:
        - CI/CD 설정 및 빌드 파이프라인
        - 코드 저장소(브랜치 정책, 보호 규칙, 권한 변경)
        - 샌드박스·테스트 환경
        - IDE와 그 확장
        - SBOM 도구와 SBOM 아티팩트
        - 로그 시스템과 로그 보존 정책
        - SaaS 등 서드파티 통합
        - 아티팩트/컨테이너 레지스트리
11. **코드 저장소·개발 워크스테이션·빌드 서버의 보안 강화**
    - 코드 저장소: 비밀 값 체크인 금지, 브랜치 보호, 백업, MFA
    - 개발 PC: 정기 패치, EDR, MFA, 행위 모니터링
    - 빌드 서버/CI/CD: 역할 분리(SoD), 환경별 비밀 값 분리, 서명된 빌드, 불변(Immutable) 빌드 아티팩트 등.
12. **애플리케이션 라이프사이클 전 기간에 걸친 공급망 유지 계획**
    - 애플리케이션이 운영되는 동안(수년 이상) **지속적으로 모니터링·분류·업데이트·설정 변경**을 수행하는  장기적인 공급망 보안 계획을 수립한다.

## 5. 예시 공격 시나리오 (Example attack scenarios)
### 시나리오 1 – SolarWinds: 신뢰된 벤더 업데이트를 통한 공급망 감염

한 조직은 네트워크 관리 솔루션을 제공하는 **신뢰된 벤더의 제품**을 사용하고 있었고, 벤더로부터 제공되는 정기 업데이트를 그대로 설치해 왔습니다.
그러나 2019년 SolarWinds 사례에서처럼, 벤더의 빌드 환경이 먼저 침해되어 **공식 업데이트 패키지 내부에 백도어(멀웨어)가 삽입**되었고, 이를 아무 의심 없이 설치한 약 **18,000개 조직이 연쇄적으로 감염**되었습니다.
이 경우, 공격자는 최종 피해 조직을 직접 공격한 것이 아니라, **공급망 상류(벤더의 빌드/배포 시스템)를 먼저 장악한 뒤, 합법적인 업데이트 채널을 통해 악성코드를 배포**한 것이다.
A03가 말하는 전형적인 “신뢰된 공급망의 붕괴” 사례다.

### 시나리오 2 – Bybit: 특정 조건에서만 동작하는 지능적 지갑 공급망 공격

2025년에는 가상자산 거래소 **Bybit**를 겨냥한 공급망 공격이 발생했다.  
공격자는 **지갑 소프트웨어(월렛)** 의 공급망을 침해해 악성 코드를 심었지만, 이 악성코드는 설치 즉시 동작하지 않고, **지갑이 실제로 사용될 때만 조건부로 작동**하도록 설계되어 있었다.
지갑이 평소와 같이 사용되는 동안, 악성 코드는 서서히 자산을 탈취하여 결과적으로 약 **15억 달러 규모의 자산 손실**로 이어졌다.
이 사례는, 공급망에서 **“성능·기능 테스트를 통과하도록 설계된 악성 코드”** 가 존재할 수 있으며, 단순 정적 분석이나 1회성 테스트만으로는 악성 행위를 발견하기 어렵다는 점을 보여준다.

### 시나리오 3 – GlassWorm: VS Code / OpenVSX 마켓플레이스 확장을 통한 웜 공격

**GlassWorm(2025)** 공격에서는, VS Code 마켓플레이스와 OpenVSX 마켓플레이스를 겨냥한 공급망 공격이 수행되었다. 공격자들은 정상적인 인기 확장을 먼저 장악하거나 위장한 뒤, 그 안에 **눈에 보이지 않는(Self-replicating) 웜 코드**를 심어 배포했다.
해당 확장은 자동 업데이트를 통해 개발자 머신에 배포되었고, 웜은 다음과 같은 행동을 수행했다.
- 로컬에 저장된 **시크릿(토큰, 키, 자격 증명)** 탈취
- C2(Command & Control) 인프라와 통신 시도
- 가능할 경우 **개발자의 크립토 월렛 자산 탈취**
이 공격은 “개발자 환경(IDE, 확장, 도구)” 자체가 이미 **공급망의 일부이자 매력적인 타깃**이며, A03에서 특히 강조하는 **외부 의존성과 도구층의 위험**을 잘 보여주는 사례이다.

### 시나리오 4 – 취약 컴포넌트·IoT 기기·Shodan을 통한 대규모 악용

많은 애플리케이션은 서드파티 컴포넌트를 **애플리케이션과 동일한 권한**으로 실행한다.  
따라서 해당 컴포넌트에 취약점이나 백도어가 존재하면, 애플리케이션 전체가 그 취약점의 영향을 동일하게 받게 된다.
예를 들어:
- **CVE-2017-5638 (Struts 2 RCE)** 같은 취약점은 업그레이드가 지연된 많은 시스템에서 원격 코드 실행(RCE)으로 이어져 대규모 침해를 야기했다.
- **IoT 기기**는 패치가 어렵거나 불가능한 경우가 많아, 한 번 취약점이 발견되면 장기간 방치되기 쉽다.
- 공격자는 **Shodan 같은 검색 엔진**을 활용해, Heartbleed와 같이 이미 패치된 취약점이라도 아직 수정되지 않은 장비들을 찾아내어 공격할 수 있다.

이 시나리오는 “취약 컴포넌트 사용”이 단지 기술적 취약점이 아니라, **공급망 전반의 패치·교체·폐기 전략 부재가 만들어 낸 구조적 위험**임을 보여준다.

---

## 참고

- [OWASP Foundation – A03:2025 Software Supply Chain Failures](https://owasp.org/Top10/2025/A03_2025-Software_Supply_Chain_Failures/ "A03 Software Supply Chain Failures - OWASP Top 10:2025")