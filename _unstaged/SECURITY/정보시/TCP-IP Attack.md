### 1-1. TCP 플래그를 이용한 포트 스캔 & 스텔스 스캔

- TCP 헤더에는 6개 플래그 존재: **URG, ACK, PSH, RST, SYN, FIN**
- 정상 동작:
    - `SYN`만 1 → SYN 패킷
    - `SYN+ACK` → 서버 응답
    - `ACK`만 1 → 데이터 전송 중
    - `FIN`만 1 → 연결 종료 요청
- 공격자는 **정상적으로 일어나지 않는 플래그 조합**을 만들어 보안장비를 우회:
    - **FIN 스캔**: 처음부터 `FIN=1`만 켜서 보냄
    - **Xmas 스캔**: 플래그 여러 개를 전부 1로 (크리스마스 트리처럼)
    - **ACK 스캔**: 처음 패킷을 ACK로 보내서 방화벽의 반응을 관찰
- 구현 스택마다 “이상한 조합”에 대한 처리가 달라서,
    - 어떤 OS는 RST를 보내고,
    - 어떤 OS는 무응답,
    - 어떤 방화벽은 로그를 안 남기고 통과시키기도 함 → **스텔스 포트 스캔(stealth port scan)** 기법.

### 1-2. IP 프래그멘테이션을 이용한 우회

- 예전에는 라우터 양쪽 링크의 MTU(MTU가 더 작은 링크) 때문에 **IP 패킷을 조각(fragmentation)** 내서 보냄.
- IP 조각 중 일부에만 TCP 헤더(포트 번호 등)가 들어있고, 나머지 조각에는 안 들어있을 수 있음.
- **저가형 보안장비**는 조각들을 다시 모아서 검사할 리소스가 부족해서,
    - 조각 하나만 보고 정책을 적용 ⇒ 포트 정보를 못 보면 통과시켜 버리는 경우가 있음.
- 그래서 공격 도구들은 **일부러 패킷을 잘게 쪼개서**(nmap 옵션 등) 보안장비를 우회하도록 설계.

### 1-3. Shodan, CVE, MITRE ATT&CK

- **Shodan**: 인터넷 전체를 상대로 포트 스캔 + 배너 수집을 자동으로 돌려서  
    “이 IP는 어떤 서비스 버전을 쓰는지”를 데이터베이스화.
- 예: `Apache 2.4.6 on CentOS, PHP x.x` 같은 배너를 그대로 노출하면  
    공격자에게 “어떤 취약점을 노려야 할지” 메뉴판을 제공하는 꼴.
- 취약점 이름 체계:
    - **CVE-YYYY-NNNN**: Common Vulnerabilities and Exposures  
        → 취약점마다 고유 번호를 붙여 전 세계적으로 통일된 이름으로 관리.
- **MITRE**:
    - CVE 번호 부여·관리하는 기관.
    - 수십만 개의 개별 취약점·공격기법을 **상위 카테고리**로 추상화한 게 **MITRE ATT&CK** 프레임워크.
    - 예: “Reconnaissance(정찰) → Active Scanning → Port Scanning” 이런 식으로 계층화.

> 교수님 포인트:
> - “**배너 정보 숨기기 / 불필요한 데몬 끄기 / 취약한 설정 제거** 등 전체적인 강화 작업을 ‘하드닝(hardening)’이라고 부른다.”
> - 정찰 단계에서 상대에게 정보를 주지 않기, 의심스러운 패킷에 반응하지 않기 가 매우 중요.