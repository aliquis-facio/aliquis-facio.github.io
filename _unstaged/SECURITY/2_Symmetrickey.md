## 1) 대칭키 암호 개요

- 다른 이름: conventional / private-key / single-key.
- 송신자와 수신자가 **같은 비밀키**를 공유한다. 안전한 사용을 위해선 **강한 알고리즘**과 **비밀키 보안**이 필수.
- 수식은 $Y=E_K(X), X=D_K(Y)$.
	- $E$: Encryption
	- $D$: Decryption
- 키 배포를 위한 **안전 채널**이 전제된다.`
- 고전 치환암호 예: **시저 암호**(알파벳 3칸 평행이동). 가능한 키가 26개뿐이라 **브루트포스**로 쉽게 깨진다.
	- $c = E(p) = (p+k) \, mod \, 26$
	- $p = D(c) = (p- k) \, mod \, 26$

## 2) 일회용 패드(One Time Pad, OTP)

- 어떤 평문이 있을 때, 평문과 길이가 같은 임의의 Key(Seed)를 XOR 연산으로 암호문을 생성하는 암호 체계이다.
- 메시지 길이만큼의 **진정한 난수 키**를 한 번만 쓰면 **정보론적으로 안전**하다. → 기밀성
- 다만 키 생성·분배가 현실적으로 어려움.
- XOR 예시로 암·복호가 성립(A⊕B⊕A=B).
```
m   = 1110100 1110010
OTP = 0011010 1101101
E(m) = m ⊕ OTP = 1101110 0011111
D(E(m)) = E(m) ⊕ OTP = 1110100 1110010
```

## One Time Password, OTP

- 암호화 알고리즘과 Key(Seed)는 고정이고, 평문에 따라 암호문을 생성하는 암호 체계이다.
- 인증(신원 확인). 사용자와 서버가 공유한 비밀과 시간/카운터로 코드 생성 → 재사용/재전송 공격에 강함

### S/KEY(= Lamport 해시 체인) 방식

- **S/KEY(= Lamport 해시 체인) 방식의 OTP**는 비밀 값(패스프레이즈/씨드에서 파생된 값)을 **서버에 알려주거나 서버가 보관할 필요가 없습니다.**
- 초기 등록: 클라이언트가 ($V_n = H^{n}(\text{secret} \parallel \text{seed})$) 같은 **체인의 머리값**만 서버에 등록합니다(비밀 자체는 미전송).
- 로그인 (i)번째: 클라이언트가 ($V_{i-1}$)을 보내면, 서버는 한 번 더 해시해서 ($H(V_{i-1}) \stackrel{?}{=} V_i$)를 확인하고, 성공하면 저장값을 ($V_{i-1}$)로 갱신합니다.
- 따라서 서버는 **해시값만** 갖고 검증하며, **비밀(secret)** 은 끝까지 서버에 알려지지 않습니다.

보안상 유의점
- 도청자는 OTP를 재사용할 수 없지만, **실시간 피싱/MITM**엔 취약할 수 있습니다.
- 서버의 저장값(해드/씨드)이 유출되면 **사전 대입 공격** 가능성이 있으니 비밀은 충분히 강하게(긴 패스프레이즈 등) 해야 합니다.

※ 비교: **HOTP/TOTP**는 서버가 **공유 비밀키**를 저장해야 하지만, **S/KEY는 비밀을 서버가 몰라도** 해시 체인으로 검증이 가능합니다.

### Time-based OTP

**TOTP**: 서버·클라이언트가 같은 시계와 비밀키를 공유하고  
`OTP = Truncate(HMAC(K, ⌊(now−T0)/X⌋))` 처럼 **시간 슬롯**을 입력으로 사용합니다.  
→ 서버가 별도의 챌린지를 보내지 않습니다(시간은 예측 가능).

### Challenge-Response 방식

서버에서 난수 생성 등을 통해 임의의 수를 생성하고 클라이언트에 그 값을 전송하면, 클라이언트가 그 값으로 OTP를 생성해 응답한 값으로 인증하는 방식이다.  
입력값이 매번 임의의 값이 된다는 측면에서는 안전성을 갖추고 있으나, 네트워크 모니터링에 의해 전송되는 값들이 노출될 경우 매우 취약해진다는 단점이 있다. 또 서버와 클라이언트 사이의 통신 횟수도 비교적 많이 요구된다.

## Block Cipher V.S. Streaming Cipher

### Block Cipher

- 블록 단위 암호화, 마지막 블록에서는 패딩 처리
- 종류: DES, AES

### Streaming Cipher

- 바이트 단위 암호화
- 종류: RC4

## 3) Data Encryption Standard, DES

![](2025-10-13-11-56-24.png)

- 64-bit(8 bytes) 블록: **56-bit 키**의 페이스텔(Feistel) 구조 + 8-bit Checksum
- 1977년 NBS=현 NIST가 FIPS PUB 46으로 채택
- 오늘날 **브루트포스와 분석**으로 안전하지 않음
- L/R 절반, E-확장, S-box, P-치환으로 라운드 구성.
- DES 키공간은 실전에서 깨졌고(1997~1999), **대안**으로 3DES와 AES가 제시됨.
- 16 라운드,48bit key

## 4) 운용 모드(ECB/CBC)와 패딩

### Electronic Code Book, ECB

블록마다 독립 암호화
- 장점: 단순·병렬화 용이, 블록 손실/손상에 견고함
- 단점: **패턴 누출**(이미지/문서 부적합).

### Cipher Block Chaining, CBC

- $C[i]=E_K(C[i−1]⊕P[i])$
- $P[i]=C[i−1]⊕D_K(C[i])$
- 평문을 암호화한 값을 그 다음 평문 암호화 키로 사용.
- **앞선 블록에 의존**.
- 초기값이 같아도 다르게 암호화 되게 하고 싶음 → 초기화 벡터(Initialization Vector, IV)가 필요.
	- 키와 동일한 크기의 난수 생성
- **PKCS#5 패딩**: “추가 바이트 수” 값을 그 개수만큼 채움(1~8바이트).
	- 예: 길이≡0(mod 8)면 `0x08`을 8바이트 채움.

## 5) 3DES와 AES

### Triple DES

![](2025-10-13-12-50-56.png)

- 두 키만으로도 구현
- C = E(k1) → D(k2) → E(k1)
- P = D(k1) → E(k2) → D(k1)
- DES 약점을 보완하지만 느림.

### Advanced Encryption Standard, AES

![](2025-10-13-13-45-57.png)
- 128/192/256-bit Block Size
- 128/192/256-bit Key. 블록 크기와 독립적
- 10~14 rounds
- 2000년 선정, 2001년 FIPS-197 표준.
- 3DES보다 **더 강하고 빠름**.
- **PKCS#5 패딩**: “추가 바이트 수” 값을 그 개수만큼 채움(1~8바이트).
	- 예: `길이 mod 8 == 7` → PM = M + `0x01`
	- 예: `길이 mod 8 == 6` → PM = M + `0x0202`
	- 예: `길이 mod 8 == 5` → PM = M + `0x030303
	- 예: `길이 mod 8 == 0` → PM = M + `0x0808080808080808`

## 6) 스트림 암호와 RC4

![](2025-10-13-13-38-03.png)
- 스트림키를 생성해 **XOR**로 처리($C_i=M_i⊕StreamKey_i$). 좋은 설계는 긴 주기·통계적 무작위성·충분한 키 길이를 가진다.
- **RC4**: KSA(키로 `S[0~255]` 치환)→PRGA(매 바이트마다 i/j 갱신·스왑·S[i]+S[j] 인덱스로 스트림키 선택)로 동작. 과거 SSL/TLS·WEP 등에서 널리 사용.

## 7) 공격 모델과 실습 코드 힌트

- 공격 모델: **암호문 단독**, **기지 평문**, **선택 평문/암호문**. 목표는 보통 **키 복구**.
- 파이썬 예제: AES-ECB(실무 비권장)·AES-CBC(+IV)·PKCS7 패딩 데모 코드가 수록됨.

# 참고

- [NAVER: DES(Data Encryption Standard)](https://m.blog.naver.com/wnrjsxo/221708511553)
- [NAVER: AES(Advanced Encryption Standard)](https://blog.naver.com/PostView.naver?blogId=wnrjsxo&logNo=221711255389)
- [Wikipedia: OTPassword](https://ko.wikipedia.org/wiki/%EC%9D%BC%ED%9A%8C%EC%9A%A9_%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8)