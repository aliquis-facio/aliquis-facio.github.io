---
layout: post
comments: true
sitemap:
  changefreq:
  priority:
title: "[COMPUTER VISION] Edge"
excerpt: Edge
date: 2025-10-17
last_modified_at: 2025-10-17
categories:
  - COMPUTER VISION
tags:
  - COMPUTER_VISION
---

# 7장. 에지(Edge)

- **유용성:** 물체 경계를 안정적으로 표시, 매칭·정합·분할의 핵심 단서.
- **어려움:** 잡음 증폭, 약한/누락(edge miss)·거짓 에지(false edge), 조명/질감 변화, 스케일 의존성.

## 7.1. 에지 검출 기초

### 7.1.1. 연속/이산 미분

- 연속 공간 미분: $$\displaystyle f'(x)=\frac{ds}{dx} = \lim_{\Delta x\to 0} \frac {s(x + \Delta x) - s(x))}{\Delta x}$$ 는 **밝기 변화율** → 에지에서 극값(피크).
- 이산 공간 미분: $$f'(x) = \frac{df}{dx} = \lim_{\Delta x\to 0} \frac {f(x + \Delta x) - f(x))}{\Delta x} = f(x{+}1)-f(x)$$
	- → 에지 연산자 마스크: `[-1][1]`
- ![](2025-10-17-12-04-21.jpg)

- 2차 미분: $$\begin{align}
			f''(x) &= \frac{d^2f}{dx^2}= f'(x) - f'(x-1) \\
			&= (f(x+1)-f(x)) - (f(x)-f(x-1)) \\
			&=f(x+1)+f(x-1)-2f(x)
			\end{align}$$

- 에지 검출 과정
	- 1차 미분에서 봉우리, 2차 미분에서 영교차를 찾음

### 7.1.2 에지 모델과 1차/2차 미분

![](../../_image/2025-10-17-12-04-28.jpg)
![](2025-10-17-12-04-43.jpg)
- **계단(step) 에지**: 밝기 불연속. 1차 미분=피크(±), 2차 미분=**0-교차(zero-crossing)**.
- **램프(ramp) 에지**: 실제 영상은 주로 램프(기울기 완만). 잡음 때문에 **스무딩 선행** 필요.
- **선(line) 에지**: 밝기 얇은 봉우리/골. 2차 미분 응답 유용.

### 7.1.3 잡음과 스무딩: 가우시안/가우시안 미분

- ![](../../_image/2025-10-17-12-31-25.jpg)
- 미분은 **고주파(잡음) 증폭** → **가우시안 스무딩 $G_\sigma$** 선행:
	- $I_\sigma = G_\sigma * I,\quad \partial_x I_\sigma = (\partial_x G_\sigma) * I$
- 가우시안은 **분리 가능** → $O(k^2)$ → $O(2k)$로 연산량 감소.
- **커널 크기**: 실무적으로 $\text{size} \approx 6\sigma+1$ (가장 작은 홀수) 권장.

## 7.2. 에지 모델과 연산자

- $\Delta x = 1$이 잡음에 너무 민감 → $\Delta x = 2$로 확장
	- $$f'(x) = \frac{df}{dx}  = \frac{f(x+1)-f(x-1)}{2}$$
	- 마스크: $\begin{bmatrix} -1 & 0 & 1\end{bmatrix}$

- 2D 그레이스케일 $I(x,y)$에서 **기울기(gradient)**:
	- $\nabla I=[I_x, I_y],\quad |\nabla I|=\sqrt{I_x^2+I_y^2},\quad \theta=\operatorname{atan2}(I_y,I_x)$
- **기본 미분 커널**
    - _Roberts_: 매우 작은 2×2 대각 미분(노이즈 취약, 오래된 방식)
    - _Prewitt_: 3×3, 미분 + 단순 평균 스무딩
    - _Sobel_: 3×3, 중앙 가중(1–2–1) 포함 → Prewitt보다 **스무딩 효과↑**
	    - 예) $G_x=\begin{bmatrix}-1&0&1\-2&0&2\-1&0&1\end{bmatrix},; G_y=G_x^\top$

## 2) 영(零)교차 이론 — Marr–Hildreth(LoG)

- **핵심 아이디어:** 가우시안으로 스무딩 후 **라플라시안 (\nabla^2)**(2차 미분) 적용 → **제로 교차** 위치를 에지로. 
	- $\nabla^2 (G_\sigma * I) = (\nabla^2 G_\sigma) * I = LoG_\sigma * I$
- **장점:** 스케일 $\sigma$로 에지의 **세밀도** 조절, 얇고 닫힌 경계 추출 용이.
- **구현 팁**
    - LoG 직접 컨볼루션 또는 **DoG(차분 가우시안)**로 근사.
    - **제로 교차 판정** 시, 이웃 픽셀 간 **부호 변화**와 **2차 미분 크기 임계**를 함께 사용해 잡음 억제.

## 3) Canny 에지 검출

### 3.1 최적성 기준(정리)

- **탐지력(Detection):** 실제 에지는 놓치지 말 것(거짓부정↓).
- **정위치(Localization):** 에지 위치 오차가 작을 것.
- **단일 응답(Single Response):** 한 에지에 다중 응답을 피할 것(거짓긍정↓).

### 3.2 파이프라인

1. **가우시안 스무딩** $\sigma$
2. **기울기** 계산(Sobel 등) → $|\nabla I|,;\theta$
3. **비최대 억제(NMS)**: $\theta$ 방향으로 국소 최대만 남김(에지 얇게)
4. **이중 임계(double threshold)**: $T_H$ (strong), $T_L$ (weak)
5. **히스테리시스 연결**: strong에 **연결된** weak만 살리고 나머지 제거

### 3.3 파라미터 가이드

- $\sigma$↑: 노이즈 억제↑, **세부 에지 손실** 가능 (두꺼운 에지 경향).
- $T_H, T_L$: 일반적으로 $T_L \approx (0.3\sim 0.5),T_H$ 범위를 탐색.
- 텍스처 강한 영역은 $T_H$를 상대적으로 올려 **잡음형 에지** 억제.

---

## 4) 컬러 에지

### 4.1 채널별 처리의 한계

- RGB **각 채널에 독립 적용 후 OR** 하면 **채널마다 에지 위치가 달라** 불일치/중복 발생.

### 4.2 벡터-값 영상의 기울기(디젠조(Di Zenzo) 접근 요지)

- R/G/B 각 채널에서 ((I_{x,c}, I_{y,c}))를 구해 **구조 텐서** 유사 형태를 구성: 
	- $$J=\begin{bmatrix}  
	    \sum_c I_{x,c}^2 & \sum_c I_{x,c}I_{y,c}\  
	    \sum_c I_{x,c}I_{y,c} & \sum_c I_{y,c}^2  
	    \end{bmatrix}$$
- **고유값/고유벡터**로 **가장 큰 변화 방향**과 강도를 추정 → **단일 방향/강도**의 에지로 정리 가능.

---

